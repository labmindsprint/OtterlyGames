"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{4554:function(e,t,a){a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]])},9637:function(e,t,a){a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},3276:function(e,t,a){a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},8896:function(e,t,a){a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},797:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});var n=a(7437),r=a(2265),i=a(6440),l=a(9692),s=a(6595),o=a(4554),c=a(8896),d=a(9637),m=a(3276);let u=(0,a(9763).Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);var p=a(2474),x=a(4326),h=a(3457),f=a(8939);function y(e){let t=Math.abs(e)||1;return()=>(t=1103515245*t+12345&2147483647)/2147483647}let b=1;function g(e,t){return Math.floor(y(window.performance?Math.floor(1e3*window.performance.now())+b++:Date.now()+b++)()*(t-e+1))+e}function v(e,t,a,n){let r=new Set([e]),i=y(Math.abs(31*e+17*t+13*a+7*n)),l=[-2,-1,1,2,10,-10],s=0;for(;r.size<t&&s<100;)if(s++,i()>.3){let t=Math.floor(i()*l.length),s=e+l[t];s>=a&&s<=n&&s!==e&&r.add(s)}else{let t=Math.floor(i()*(n-a+1))+a;t!==e&&r.add(t)}let o=e+3;for(;r.size<t;)o!==e&&o>=a&&o<=n&&r.add(o),o=o+1>n?a:o+1;let c=y(Math.abs(13*e+7*a+3*n));return Array.from(r).sort(()=>c()-.5)}function w(e,t){switch(e){case h.av.Easy:return j();case h.av.Medium:return function(){if(0===g(0,1)){let e=g(1,5),t=g(1,10),a=e*t,n=v(a,4,1,50);return{prompt:"".concat(e," \xd7 ").concat(t," = ?"),correctAnswer:a,choices:n.map(String),correctIndex:n.indexOf(a),operation:h.i3.Multiplication,grade:h.hs.Grade2,timeLimitSeconds:12,difficulty:5}}{let e=g(2,5),t=g(1,10),a=e*t,n=v(t,4,1,20);return{prompt:"".concat(a," \xf7 ").concat(e," = ?"),correctAnswer:t,choices:n.map(String),correctIndex:n.indexOf(t),operation:h.i3.Division,grade:h.hs.Grade2,timeLimitSeconds:12,difficulty:5}}}();case h.av.Hard:return function(e){let t=g(1,10),a=e*t,n=g(0,2);if(2===n){let n=v(t,4,1,20);return{prompt:"".concat(a," \xf7 ").concat(e," = ?"),correctAnswer:t,choices:n.map(String),correctIndex:n.indexOf(t),operation:h.i3.Division,grade:h.hs.Grade3,timeLimitSeconds:10,difficulty:7}}if(1===n){let n=v(t,4,1,20);return{prompt:"".concat(e," \xd7 _ = ").concat(a),correctAnswer:t,choices:n.map(String),correctIndex:n.indexOf(t),operation:h.i3.Multiplication,grade:h.hs.Grade3,timeLimitSeconds:10,difficulty:7}}{let n=v(a,4,1,100);return{prompt:"".concat(e," \xd7 ").concat(t," = ?"),correctAnswer:a,choices:n.map(String),correctIndex:n.indexOf(a),operation:h.i3.Multiplication,grade:h.hs.Grade3,timeLimitSeconds:10,difficulty:7}}}(t||g(6,10));case h.av.God:return function(e){let t=g(1,10),a=e*t,n=g(0,2);if(2===n){let n=v(t,4,1,20);return{prompt:"".concat(a," \xf7 ").concat(e," = ?"),correctAnswer:t,choices:n.map(String),correctIndex:n.indexOf(t),operation:h.i3.Division,grade:h.hs.Grade3,timeLimitSeconds:15,difficulty:10}}if(1===n){let n=v(t,4,1,20);return{prompt:"".concat(e," \xd7 _ = ").concat(a),correctAnswer:t,choices:n.map(String),correctIndex:n.indexOf(t),operation:h.i3.Multiplication,grade:h.hs.Grade3,timeLimitSeconds:15,difficulty:10}}{let n=v(a,4,e,10*e);return{prompt:"".concat(e," \xd7 ").concat(t," = ?"),correctAnswer:a,choices:n.map(String),correctIndex:n.indexOf(a),operation:h.i3.Multiplication,grade:h.hs.Grade3,timeLimitSeconds:15,difficulty:10}}}(t||g(11,20));default:return j()}}function j(){let e=g(1,5),t=g(1,10),a=e*t,n=v(a,4,1,50);return{prompt:"".concat(e," \xd7 ").concat(t," = ?"),correctAnswer:a,choices:n.map(String),correctIndex:n.indexOf(a),operation:h.i3.Multiplication,grade:h.hs.Grade1,timeLimitSeconds:10,difficulty:3}}var N=a(9933),E=a(1876),S=a(224),k=a(3487),M=a(9478);let _=[{name:"FIZZLE",color:"#64748b",glow:"#475569",multiplier:1,minCorrect:0},{name:"SPARK",color:"#3b82f6",glow:"#2563eb",multiplier:1.5,minCorrect:1},{name:"BLAZE",color:"#8b5cf6",glow:"#7c3aed",multiplier:2,minCorrect:2},{name:"INFERNO",color:"#f59e0b",glow:"#d97706",multiplier:2.5,minCorrect:3},{name:"ULTRA!",color:"#ef4444",glow:"#dc2626",multiplier:3,minCorrect:4}],I={[h.av.Easy]:{duration:1e4,maxQuestions:3},[h.av.Medium]:{duration:9e3,maxQuestions:4},[h.av.Hard]:{duration:8e3,maxQuestions:5},[h.av.God]:{duration:8e3,maxQuestions:5}};function D(e){let{missileType:t,basePowerLevel:a,difficulty:s,battleTableNumber:o,isActive:c,onComplete:d}=e,[m,u]=(0,r.useState)("intro"),[p,x]=(0,r.useState)(0),[h,f]=(0,r.useState)(0),[y,b]=(0,r.useState)(null),[g,v]=(0,r.useState)(""),[j,N]=(0,r.useState)(""),[E,k]=(0,r.useState)(8e3),[D,C]=(0,r.useState)(!1),[T,P]=(0,r.useState)(!1),[A,R]=(0,r.useState)(0),[z,H]=(0,r.useState)(0),L=(0,r.useRef)(null),O=(0,r.useRef)(0),B=(0,r.useRef)(!1),F=(0,r.useRef)(0),q=(0,r.useRef)(new Set),Z=I[s]||{duration:8e3,maxQuestions:5},G=Z.duration,V=Z.maxQuestions,W=_[Math.min(z,_.length-1)],X=(0,r.useCallback)(()=>{let e=w(s,o||void 0),t=0;for(;q.current.has(e.prompt)&&t<10;)e=w(s,o||void 0),t++;q.current.add(e.prompt),b(e),N(e.choices[e.correctIndex]),v("")},[s,o]);(0,r.useEffect)(()=>{if(!c){u("intro"),x(0),f(0),b(null),v(""),k(G),H(0),B.current=!1,F.current=0,q.current.clear();return}(0,M.wI)(!1),(0,M.NH)("heavy");let e=setTimeout(()=>{u("charging"),O.current=Date.now(),X(),L.current=setInterval(()=>{let e=Math.max(0,G-(Date.now()-O.current));k(e),e<=0&&(L.current&&clearInterval(L.current),Y())},50)},1200);return()=>{clearTimeout(e),L.current&&clearInterval(L.current)}},[c]);let Y=(0,r.useCallback)(()=>{if(B.current)return;B.current=!0,L.current&&(clearInterval(L.current),L.current=null),u("result");let e=F.current,t=_.reduce((t,a,n)=>e>=a.minCorrect?n:t,0);H(t),t>=4?((0,M.wI)(!0),(0,M.NH)("heavy"),R(3)):t>=2&&((0,M.wI)(!0),(0,M.NH)("medium")),setTimeout(()=>{let e=_[t];d(t,e.multiplier)},t>=4?2e3:t>=2?1500:1e3)},[d]);(0,r.useEffect)(()=>{H(_.reduce((e,t,a)=>p>=t.minCorrect?a:e,0))},[p]);let U=(0,r.useCallback)(e=>{if("charging"!==m||!y||B.current)return;if("clear"===e){v(""),(0,M.p7)();return}if("back"===e){v(e=>e.slice(0,-1)),(0,M.p7)();return}(0,M.p7)(),(0,M.NH)("light");let t=g+e;if(!(t.length>j.length)&&(v(t),t.length===j.length)){let e=t===j,a=h+1;if(f(a),e){let e=p+1;x(e),F.current=e,C(!0),setTimeout(()=>C(!1),200),(0,M.mx)("correct"),(0,M.NH)("medium"),e>=3&&(R(e>=4?2:1),setTimeout(()=>R(0),300)),(0,M.eD)("powerUpAppear",{volume:.5+.1*e,playbackRate:.8+.1*e})}else P(!0),setTimeout(()=>P(!1),200),(0,M.mx)("wrong"),(0,M.NH)("light");if(a>=V){L.current&&clearInterval(L.current),B.current=!0;let t=e?p+1:p,a=_.reduce((e,a,n)=>t>=a.minCorrect?n:e,0);H(a),u("result"),a>=4?((0,M.wI)(!0),(0,M.NH)("heavy"),R(3)):a>=2&&((0,M.wI)(!0),(0,M.NH)("medium")),setTimeout(()=>{let e=_[a];d(a,e.multiplier)},a>=4?2e3:a>=2?1500:1e3)}else setTimeout(()=>X(),100)}},[m,y,g,j,h,p,V,X,d,Y]);if((0,r.useEffect)(()=>{if("charging"!==m)return;let e=e=>{/^[0-9]$/.test(e.key)?U(e.key):"Backspace"===e.key&&U("back")};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m,U]),!c)return null;let K=E/G;return(0,n.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1,x:A>0?[0,-(2*A),2*A,-A,A,0]:0},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-50 flex flex-col items-center justify-center",style:{background:"radial-gradient(ellipse at center, ".concat(W.color,"15 0%, #0f172a 70%)")},children:[(0,n.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[z>=1&&(0,n.jsx)(i.E.div,{animate:{scale:[1,1.5,1],opacity:[.1,.3,.1]},transition:{duration:1.5,repeat:1/0},className:"absolute inset-0",style:{background:"radial-gradient(circle at center, ".concat(W.color,"30, transparent 70%)")}}),z>=2&&Array.from({length:12}).map((e,t)=>(0,n.jsx)(i.E.div,{animate:{y:[100,-100],x:[20*Math.random()-10,20*Math.random()-10],opacity:[0,.8,0]},transition:{duration:2+Math.random(),repeat:1/0,delay:.2*t},className:"absolute w-1 h-1 rounded-full",style:{left:"".concat(10+t/12*80,"%"),bottom:0,background:W.color,boxShadow:"0 0 6px ".concat(W.color)}},t)),z>=3&&(0,n.jsx)(i.E.div,{animate:{opacity:[.3,.6,.3]},transition:{duration:.5,repeat:1/0},className:"absolute inset-0 pointer-events-none",style:{boxShadow:"inset 0 0 80px ".concat(W.color,"60")}})]}),(0,n.jsx)(l.M,{children:"intro"===m&&(0,n.jsxs)(i.E.div,{initial:{scale:3,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},transition:{duration:.4,ease:"easeOut"},className:"flex flex-col items-center gap-4 z-10",children:[(0,n.jsx)(i.E.div,{animate:{opacity:[0,1,0,1]},transition:{duration:.3,repeat:3},className:"text-6xl",children:"⚡"}),(0,n.jsxs)(i.E.h1,{animate:{textShadow:["0 0 20px #fbbf24","0 0 40px #f59e0b","0 0 20px #fbbf24"]},transition:{duration:.5,repeat:1/0},className:"text-3xl sm:text-4xl font-black text-amber-400 text-center tracking-wider",children:["CHARGE YOUR",(0,n.jsx)("br",{}),"MISSILE!"]}),(0,n.jsx)(i.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-slate-400 text-sm",children:"Answer fast to power up!"})]})}),"charging"===m&&y&&(0,n.jsxs)("div",{className:"flex flex-col items-center w-full max-w-lg px-4 gap-3 z-10",children:[(0,n.jsxs)("div",{className:"w-full flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex gap-1 shrink-0",children:_.slice(1).map((e,t)=>(0,n.jsx)(i.E.div,{animate:p>=e.minCorrect?{scale:[1,1.3,1],boxShadow:"0 0 12px ".concat(e.color)}:{},transition:{duration:.3},className:"w-6 h-6 sm:w-7 sm:h-7 rounded-md border-2 flex items-center justify-center text-[10px] font-black",style:{borderColor:p>=e.minCorrect?e.color:"#334155",background:p>=e.minCorrect?e.color:"#1e293b",color:p>=e.minCorrect?"#fff":"#475569"},children:p>=e.minCorrect?"✓":t+1},t))}),(0,n.jsx)("div",{className:"flex-1 h-3 bg-slate-800 rounded-full overflow-hidden border border-slate-700",children:(0,n.jsx)(i.E.div,{className:"h-full rounded-full",style:{width:"".concat(100*K,"%"),background:K>.5?"linear-gradient(90deg, ".concat(W.color,", ").concat(W.glow,")"):K>.25?"linear-gradient(90deg, #f59e0b, #d97706)":"linear-gradient(90deg, #ef4444, #dc2626)",boxShadow:"0 0 8px ".concat(K>.5?W.color:K>.25?"#f59e0b":"#ef4444")},transition:{duration:.05}})})]}),(0,n.jsx)(l.M,{mode:"wait",children:(0,n.jsx)(i.E.div,{initial:{scale:.5,opacity:0,y:-10},animate:{scale:1,opacity:1,y:0},exit:{scale:1.5,opacity:0},transition:{duration:.2},className:"text-sm font-black tracking-widest",style:{color:W.color,textShadow:"0 0 10px ".concat(W.glow)},children:z>0?W.name:"CHARGING..."},z)}),(0,n.jsxs)("div",{className:"relative flex items-center justify-center h-16 w-full",children:[z>=1&&(0,n.jsx)(i.E.div,{animate:{scale:[1,1.2+.1*z,1],opacity:[.3,.6,.3]},transition:{duration:.8,repeat:1/0},className:"absolute rounded-full",style:{width:80+20*z,height:40+10*z,background:"radial-gradient(ellipse, ".concat(W.color,"50, transparent)"),filter:"blur(8px)"}}),(0,n.jsx)(i.E.div,{animate:z>=3?{scale:[1,1.05,1],x:[0,-1,1,-1,0]}:{},transition:{duration:.3,repeat:1/0},children:(0,n.jsx)(S.vy,{MissileType:t,powerLevel:Math.min(4,a+z),className:"w-32 h-16",animated:!0})})]}),(0,n.jsxs)(i.E.div,{className:"relative w-full",animate:D?{borderColor:"#22c55e"}:T?{borderColor:"#ef4444"}:{},children:[(0,n.jsxs)(l.M,{children:[D&&(0,n.jsx)(i.E.div,{initial:{opacity:.6},animate:{opacity:0},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 rounded-2xl z-10 pointer-events-none",style:{background:"#22c55e30"}}),T&&(0,n.jsx)(i.E.div,{initial:{opacity:.6},animate:{opacity:0},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 rounded-2xl z-10 pointer-events-none",style:{background:"#ef444430"}})]}),(0,n.jsxs)("div",{className:"bg-slate-900/90 border-2 rounded-2xl p-4 text-center backdrop-blur-sm",style:{borderColor:W.color+"60"},children:[(0,n.jsx)(i.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.15},className:"text-2xl sm:text-3xl font-bold text-white mb-3",children:y.prompt},y.prompt),(0,n.jsx)("div",{className:"flex items-center justify-center gap-1 min-h-[44px]",children:Array.from({length:j.length}).map((e,t)=>(0,n.jsx)("div",{className:"w-10 h-11 sm:w-12 sm:h-13 rounded-lg border-2 flex items-center justify-center text-2xl sm:text-3xl font-bold",style:{borderColor:g[t]?W.color:"#475569",background:g[t]?W.color+"20":"#1e293b",color:"#fff"},children:g[t]||""},t))}),(0,n.jsxs)("div",{className:"mt-2 text-xs text-slate-500",children:[h+1," / ",V]})]})]}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-1.5 w-full max-w-xs mx-auto",children:["1","2","3","4","5","6","7","8","9","⌫","0","C"].map(e=>(0,n.jsx)(i.E.button,{whileTap:{scale:.9},onClick:()=>{"⌫"===e?U("back"):"C"===e?U("clear"):U(e)},className:"h-11 sm:h-12 text-lg sm:text-xl font-bold rounded-xl shadow-lg transition-all active:shadow-inner",style:{background:"⌫"===e||"C"===e?"#475569":W.color+"40",color:"#fff",border:"1px solid ".concat(W.color,"30")},children:e},e))})]}),(0,n.jsx)(l.M,{children:"result"===m&&(0,n.jsxs)(i.E.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.4,type:"spring",bounce:.3},className:"flex flex-col items-center gap-4 z-10",children:[z>=4&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{initial:{opacity:.8},animate:{opacity:0},transition:{duration:.5},className:"fixed inset-0 bg-white z-0 pointer-events-none"}),[0,.2,.4].map((e,t)=>(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:.8},animate:{scale:4,opacity:0},transition:{duration:1,delay:e},className:"absolute rounded-full border-4",style:{width:100,height:100,borderColor:_[4].color}},t)),Array.from({length:20}).map((e,t)=>{let a=360*t/20;return(0,n.jsx)(i.E.div,{initial:{x:0,y:0,scale:1},animate:{x:150*Math.cos(a*Math.PI/180),y:150*Math.sin(a*Math.PI/180),scale:0,opacity:[1,0]},transition:{duration:.8,delay:.1},className:"absolute w-2 h-2 rounded-full",style:{background:t%2==0?"#ef4444":"#fbbf24",boxShadow:"0 0 8px ".concat(t%2==0?"#ef4444":"#fbbf24")}},t)})]}),(0,n.jsx)(i.E.div,{animate:z>=4?{scale:[1,1.1,1],textShadow:["0 0 20px ".concat(W.color),"0 0 40px ".concat(W.color),"0 0 20px ".concat(W.color)]}:{},transition:{duration:.5,repeat:z>=4?1/0:0},className:"text-4xl sm:text-5xl font-black tracking-widest text-center",style:{color:W.color,textShadow:"0 0 20px ".concat(W.glow)},children:W.name}),(0,n.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-lg font-bold text-slate-300",children:[W.multiplier,"x DAMAGE"]}),(0,n.jsxs)("div",{className:"relative",children:[z>=1&&(0,n.jsx)(i.E.div,{animate:{scale:[1,1.3,1],opacity:[.4,.7,.4]},transition:{duration:.6,repeat:1/0},className:"absolute inset-0 rounded-full",style:{background:"radial-gradient(circle, ".concat(W.color,"60, transparent)"),filter:"blur(12px)",transform:"scale(1.5)"}}),(0,n.jsx)(S.vy,{MissileType:t,powerLevel:Math.min(4,a+z),className:"w-40 h-20",animated:!0})]}),(0,n.jsx)("div",{className:"flex gap-2",children:Array.from({length:V}).map((e,t)=>(0,n.jsx)("div",{className:"w-4 h-4 rounded-full",style:{background:t<p?"#22c55e":t<h?"#ef4444":"#334155",boxShadow:t<p?"0 0 6px #22c55e":"none"}},t))})]})})]})}var C=a(2164),T=a(6799);let P={[h.vD.I]:"I",[h.vD.II]:"II",[h.vD.III]:"III",[h.vD.IV]:"IV"},A=e=>P[e]||"I",R={[h.av.Easy]:75,[h.av.Medium]:90,[h.av.Hard]:100,[h.av.God]:120},z={[h.av.Easy]:6,[h.av.Medium]:8,[h.av.Hard]:10,[h.av.God]:12},H=e=>e<=5?4:6===e?3:7===e?2:0,L={[h.av.Easy]:1,[h.av.Medium]:2,[h.av.Hard]:3,[h.av.God]:4},O=e=>e<=5?.95:6===e?1:7===e?1.05:1.1,B=e=>e<30?1:e<100?1.05:e<300?1.1:1.15,F=e=>e<=5?1:e<=15?1.1:e<=30?1.2:e<=60?1.25:1.3,q={green:1.3,yellow:1,red:.7,timeout:0,wrong:0},Z={green:.6,yellow:.3,red:.1,timeout:0,wrong:0};function G(e){var t,a,y,b,v,j,_,I,P;let{onBack:G,onBattleSetup:V,difficulty:W=h.av.Easy}=e,{customizations:X,settings:Y,progress:U,setCustomization:K,recordBattleResult:Q,addCoins:$,addFuelFromAd:J,updateDailyProgress:ee}=(0,p.G)(),{showEnergyToast:et}=(0,x.p)();L[W];let ea=O(Y.playerAge||6),en=B(U.battlesPlayed||0),er=(null===(t=f.wh[W])||void 0===t?void 0:t.enemyDamageMultiplier)||1,ei=(null===(a=f.wh[W])||void 0===a?void 0:a.playerHPMultiplier)||1,el=ea*en*er,es=X.selectedTank||h.zB.Pebble,eo=X.selectedMissile||"laser_beam",ec=X.selectedMissilePower||h.vD.I,ed=f.Rm[eo]||Object.values(f.Rm)[0],em=Math.round(((f.Hr[es]||f.Hr[h.zB.Pebble]).baseHP||100)*ei),eu=(0,C.tE)(),[ep,ex]=(0,r.useState)(!1),[eh,ef]=(0,r.useState)(!1),[ey,eb]=(0,r.useState)({coins:0,fuel:!1}),[eg,ev]=(0,r.useState)(()=>(0,C.Kc)());(0,r.useEffect)(()=>{let e=setInterval(()=>{ev((0,C.Kc)())},1e3);return()=>clearInterval(e)},[]);let[ew,ej]=(0,r.useState)(!1),[eN,eE]=(0,r.useState)(!1),eS=(0,r.useRef)(null),ek=(0,r.useRef)("green"),eM=(0,r.useRef)(!1),e_=(0,r.useRef)(null);(0,r.useEffect)(()=>(ej(!0),eM.current=!1,(0,M.vB)(),(0,M.kK)(Y.soundEnabled),()=>{null!==e_.current&&(cancelAnimationFrame(e_.current),e_.current=null)}),[Y.soundEnabled]),(0,r.useEffect)(()=>{let e=()=>{eE(window.innerWidth>window.innerHeight)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let[eI,eD]=(0,r.useState)(em),eC=F(U.battlesWon||0),eT=Math.round((R[W]||75)*eC),[eP,eA]=(0,r.useState)(eT),[eR,ez]=(0,r.useState)("table_review"),[eH,eL]=(0,r.useState)(null),[eO,eB]=(0,r.useState)(""),[eF,eq]=(0,r.useState)(""),[eZ,eG]=(0,r.useState)(null),[eV,eW]=(0,r.useState)(null),[eX,eY]=(0,r.useState)(!1),[eU,eK]=(0,r.useState)(!1),[eQ,e$]=(0,r.useState)(6),[eJ,e0]=(0,r.useState)("green"),[e1,e5]=(0,r.useState)(!1),e2=(0,r.useRef)(null),e3=(0,r.useRef)(0),[e4,e6]=(0,r.useState)({x:0,y:0,rotation:0,isPlayer:!0}),[e8,e7]=(0,r.useState)(!1),[e9,te]=(0,r.useState)(null),[tt,ta]=(0,r.useState)(0),[tn,tr]=(0,r.useState)(!1),[ti,tl]=(0,r.useState)(null),[ts,to]=(0,r.useState)(!1),[tc,td]=(0,r.useState)(null),[tm,tu]=(0,r.useState)(1),[tp,tx]=(0,r.useState)(!1),[th,tf]=(0,r.useState)(1),[ty,tb]=(0,r.useState)(1),[tg,tv]=(0,r.useState)(!1),[tw,tj]=(0,r.useState)(1),tN=(0,r.useRef)(1),[tE,tS]=(0,r.useState)(0),[tk,tM]=(0,r.useState)(0),[t_,tI]=(0,r.useState)(0),[tD,tC]=(0,r.useState)(0),tT=(0,r.useRef)(0),tP=(0,r.useRef)(0),tA=(0,r.useRef)(0),tR=(0,r.useRef)(Date.now()),tz=(0,r.useRef)(0),tH=(0,r.useRef)(0),tL=(0,r.useRef)(!1),[tO,tB]=(0,r.useState)(15),tF=(0,r.useRef)(null);(0,r.useEffect)(()=>{if("table_review"===eR)return tF.current=setInterval(()=>{tB(e=>e<=1?(tF.current&&(clearInterval(tF.current),tF.current=null),ez("player_loading"),0):e-1)},1e3),()=>{tF.current&&(clearInterval(tF.current),tF.current=null)}},[eR]);let tq=(0,r.useCallback)(()=>{tF.current&&(clearInterval(tF.current),tF.current=null),ez("player_loading")},[]),[tZ]=(0,r.useState)(()=>(function(e){switch(e){case h.av.Hard:return g(6,10);case h.av.God:return g(11,20);default:return null}})(W)),tG=eo.toString().replace(/([A-Z])/g,"_$1").toLowerCase().replace(/^_/,"")||"laser_beam",tV=A(tm),tW=f.th.physics.powerForceMultiplier[tV]||f.th.physics.powerForceMultiplier.I;(0,r.useEffect)(()=>{let e=ec||1;tu(e),tf(e)},[ec]);let tX=Object.keys(f.Hr),[tY,tU]=(0,r.useState)(h.zB.Pebble),tK=H(Y.playerAge||6),tQ=(z[W]||6)+tK;(0,r.useEffect)(()=>{tU(tX[Math.floor(Math.random()*tX.length)])},[]);let t$=e=>{let t=e/(tQ+tA.current);return t>.66?"green":t>.33?"yellow":"red"},tJ=e=>{switch(e){case"green":return"bg-green-500";case"yellow":return"bg-yellow-500";case"red":return"bg-red-500"}},t0=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=w(W,tZ||void 0);eL(t),e5(e),eq(t.choices[t.correctIndex]),eB(""),eG(null),e$(tQ+tA.current),e0("green"),e3.current=Date.now()},[W,tZ,tQ]);(0,r.useEffect)(()=>{if("player_question"===eR||"enemy_question"===eR){if(eX||eM.current){e2.current&&(clearInterval(e2.current),e2.current=null);return}if(null===eZ)return e2.current=setInterval(()=>{if(eM.current){e2.current&&(clearInterval(e2.current),e2.current=null);return}e$(e=>eM.current?e:Math.max(0,e-.1));let e=Math.max(0,tQ+tA.current-(Date.now()-e3.current)/1e3),t=t$(e);t!==ek.current&&("yellow"===t?((0,M.bZ)("yellow"),(0,M.NH)("light")):"red"===t&&((0,M.bZ)("red"),(0,M.NH)("medium")),ek.current=t),e0(t),e<=0&&!eM.current&&t1()},100),()=>{e2.current&&(clearInterval(e2.current),e2.current=null)}}},[eR,eZ,eX]);let t1=()=>{e2.current&&(clearInterval(e2.current),e2.current=null),!eM.current&&(tL.current||(tL.current=!0,eG("timeout"),(0,M.mx)("timeout"),(0,M.NH)("heavy"),setTimeout(()=>{eM.current||("player_question"===eR?t3("timeout"):"enemy_question"===eR&&t4("timeout"))},800)))};(0,r.useEffect)(()=>{let e=null,t=!1;if("player_loading"===eR||"enemy_loading"===eR){if(eM.current||eX)return;ta(0);let a=Date.now();eS.current=(0,M.fG)();let n=()=>{if(t)return;if(eM.current){(0,M.Ap)(eS.current),eS.current=null;return}let r=Math.min((Date.now()-a)/500,1);if(ta(r),r<1)e=requestAnimationFrame(n);else{(0,M.Ap)(eS.current),eS.current=null;let e="player_loading"===eR&&t_>0&&t_%3==0,t=ec||1;tu(t),tf(t),ek.current="green",e?(ez("charge_round"),tj(1),tN.current=1,tv(!0)):"player_loading"===eR?(ez("player_question"),t0(!1),tL.current=!1,tS(e=>(tz.current=e+1,e+1))):(ez("enemy_question"),t0(!1),tL.current=!1,tS(e=>(tz.current=e+1,e+1)))}};e=requestAnimationFrame(n)}return()=>{t=!0,null!==e&&cancelAnimationFrame(e),eS.current&&((0,M.Ap)(eS.current),eS.current=null)}},[eR,eX,t0,eV]),(0,r.useEffect)(()=>{let e=e=>{if("player_question"!==eR&&"enemy_question"!==eR||!eH||null!==eZ)return;let t=e.key;if(/^[0-9]$/.test(t)){let e=eO+t;e.length<=eF.length&&((0,M.p7)(),(0,M.NH)("light"),eB(e),e.length===eF.length&&t2(e))}"Backspace"===t&&((0,M.p7)(),eB(e=>e.slice(0,-1)))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[eR,eH,eO,eF,eZ]);let t5=e=>{if("player_question"!==eR&&"enemy_question"!==eR||!eH||null!==eZ)return;if((0,M.p7)(),(0,M.NH)("light"),"clear"===e){eB("");return}if("back"===e){eB(e=>e.slice(0,-1));return}let t=eO+e;t.length<=eF.length&&(eB(t),t.length===eF.length&&t2(t))},t2=e=>{if(tL.current)return;tL.current=!0,e2.current&&clearInterval(e2.current);let t=e===eF;eG(t?"correct":"wrong"),(0,M.mx)(t?"correct":"wrong"),(0,M.NH)(t?"medium":"heavy"),t?(tM(e=>(tH.current=e+1,e+1)),tI(e=>{let t=e+1;return tC(e=>Math.max(e,t)),t}),tP.current=0,tA.current>0&&(tA.current=Math.max(0,tA.current-1))):(tI(0),tP.current+=1,tP.current>=3&&(tA.current=Math.min(4,tA.current+2))),t||(tT.current+=1),setTimeout(()=>{"player_question"===eR?t3(t?eJ:"wrong"):"enemy_question"===eR&&t4(t?eJ:"wrong")},t?600:3e3)},t3=e=>{if(eM.current)return;ez("player_flying"),e7(!0),(0,M.bi)(tG,tm),(0,M.NH)("heavy");let t="timeout"!==e&&"wrong"!==e,a=(f.Hr[es]||f.Hr[h.zB.Pebble]).fireSpeed||1,n=((null==ed?void 0:ed.baseDamage)||10)*(tW||1),r=q[e],i=tN.current>1?tN.current:1,l=n*a*r*i;t6(!0,t,()=>{eM.current||(t?((0,M.OR)(tG,!0,tm),(0,M.Xb)(!1),(0,M.NH)("heavy"),eA(e=>{let t=Math.max(0,e-l);return t<=0&&!eM.current?((0,M.Xb)(!0),setTimeout(()=>t8(!0),500)):eM.current||setTimeout(()=>{if(!eM.current){let e=ec||1;tu(e),tf(e),tj(1),tN.current=1,ez("enemy_loading")}},800),t}),te("enemy"),tl({hit:!0,damage:l,blocked:r<1?n*a*i*(1-r):0})):((0,M.OR)(tG,!1,tm),te("ground"),tr(!0),tl({hit:!1,damage:0,blocked:0}),setTimeout(()=>{if(eM.current)return;tr(!1);let e=ec||1;tu(e),tf(e),ez("enemy_loading")},800)),setTimeout(()=>te(null),600))})},t4=e=>{if(eM.current)return;td("green"===e?"perfect":"yellow"===e?"good":"red"===e?"weak":"failed"),ez("enemy_flying"),e7(!0),(0,M.bi)(void 0,2),(0,M.NH)("medium");let t=(f.Hr[es]||f.Hr[h.zB.Pebble]).defense||1,a=Z[e],n=15*el,r=n*Math.min(.65,a*t),i=Math.max(.25*n,n-r);t6(!1,!0,()=>{eM.current||((0,M.OR)(void 0,!0,2),(0,M.NH)("heavy"),a>=.7?(0,M.$1)("high"):a>=.4?(0,M.$1)("medium"):a>0&&(0,M.$1)("low"),(0,M.Xb)(!1),eD(e=>{let t=Math.max(0,e-i);return t<=0&&!eM.current?((0,M.Xb)(!0),setTimeout(()=>t8(!1),500)):eM.current||setTimeout(()=>{eM.current||ez("player_loading")},800),t}),te("player"),tl({hit:!0,damage:i,blocked:r}),setTimeout(()=>te(null),600))})},t6=(e,t,a)=>{let n=e?25:75,r=e?t?75:55:11,i=t?82:95,l=t?15:25,s=e&&tN.current>1&&t,o=s?800:0,c=t?800:1e3,d=Date.now(),m=null,u=!1,p=e=>{if(t)return 82-l*Math.sin(e*Math.PI);if(e<.4)return 82-l*Math.sin(e/.4*Math.PI*.5);{let t=82-l;return t+(e-.4)/.6*(i-t)}},x=a=>{let s=n+(r-n)*a;return{x:s,y:p(a),rotation:180/Math.PI*Math.atan2(t?-l*Math.PI*Math.cos(a*Math.PI):a<.4?-(.5*Math.PI/.4*l)*Math.cos(a/.4*Math.PI*.5):(i-(82-l))/.6,r-n),isPlayer:e}};e6(x(0)),to(!1);let h=()=>{let e=Date.now()-d,t=e;if(s){let a=.4*c;e>=a&&!u&&(u=!0,m=Date.now(),to(!0),(0,M.wI)(!0),(0,M.NH)("heavy")),null!==m&&(Date.now()-m<o?t=a:(to(!1),t=e-o))}let n=Math.min(t/c,1);e6(x(n)),e<c+o||n<1?e_.current=requestAnimationFrame(h):(e_.current=null,e7(!1),to(!1),a())};e_.current=requestAnimationFrame(h)},t8=e=>{if(eM.current)return;eM.current=!0,ez("battle_end"),(0,M.zT)(),(0,M.Ap)(eS.current),eS.current=null,e2.current&&(clearInterval(e2.current),e2.current=null),e7(!1),te(null),to(!1);let t=Math.floor((Date.now()-tR.current)/1e3),a=tz.current,n=tH.current,r=a>0?n/a*100:0,i={[h.av.Easy]:f.th.battle.winEasy,[h.av.Medium]:f.th.battle.winMedium,[h.av.Hard]:f.th.battle.winHard,[h.av.God]:f.th.battle.winGod},l=0;e?(l=i[W]||f.th.battle.winEasy,r>70&&(l+=Math.floor((r-70)/10)*f.th.battle.accuracyBonus),r>=100&&(l+=f.th.battle.perfectBonus)):l=f.th.battle.loseReward;let s={won:e,accuracy:r,totalShots:a,correctAnswers:n,totalTime:t,coinsEarned:l,difficulty:W,streak:tD};if(eW(s),e?((0,M.eR)(),setTimeout(()=>(0,M.vS)(),500)):(0,M.VN)(),(0,M.NH)("heavy"),Q(s),ee("battles",1),ee("questions",n),ee("accuracy",0,{accuracy:r}),ee("streak",0,{streak:tD}),e){(W===h.av.Hard||W===h.av.God)&&ee("win_difficulty",1,{difficulty:W}),(0,T.Wd)();let e=U.battlesWon+1;(0,T.nZ)(e)&&setTimeout(()=>{eK(!0),(0,T.Hb)()},2e3)}try{window.parent!==window&&window.parent.postMessage({type:"gameEnd",game:"mathtank",result:e?"won":"lost"},"*")}catch(e){}};return ew?(0,n.jsxs)("div",{className:"w-full h-screen flex flex-col bg-gradient-to-b from-pink-300 via-purple-300 to-green-400 overflow-hidden",style:{minHeight:"100dvh",maxHeight:"100dvh",paddingTop:"calc(env(safe-area-inset-top, 0px) + 16px)",paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:[(0,n.jsx)(l.M,{children:"table_review"===eR&&(0,n.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"absolute inset-0 z-[60] bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 flex flex-col",style:{paddingTop:"calc(env(safe-area-inset-top, 0px) + 16px)",paddingBottom:"calc(env(safe-area-inset-bottom, 0px) + 16px)"},children:[(0,n.jsxs)("div",{className:"text-center px-4 pt-4 pb-2",children:[(0,n.jsx)(i.E.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-yellow-300 font-black",style:{fontSize:"clamp(1.5rem, 6vw, 2.25rem)"},children:tZ?"\uD83D\uDCDA Table of ".concat(tZ):"\uD83D\uDCDA Multiplication Tables"}),(0,n.jsxs)("div",{className:"text-white/50 text-sm mt-1",children:["Study before battle • ",tO,"s"]}),(0,n.jsx)("div",{className:"w-full max-w-md mx-auto h-2 bg-slate-700 rounded-full overflow-hidden mt-3",children:(0,n.jsx)(i.E.div,{className:"h-full bg-yellow-400 rounded-full",initial:{width:"100%"},animate:{width:"".concat(tO/15*100,"%")},transition:{duration:.5}})})]}),(0,n.jsx)("div",{className:"flex-1 min-h-0 overflow-y-auto px-4 py-3",children:(0,n.jsx)("div",{className:"max-w-md mx-auto",children:tZ?(0,n.jsx)("div",{className:"bg-slate-700/60 rounded-2xl p-4 border border-slate-600",children:(0,n.jsx)("div",{className:"grid grid-cols-2 gap-x-6 gap-y-2",children:Array.from({length:12},(e,t)=>t+1).map(e=>(0,n.jsxs)(i.E.div,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},transition:{delay:.06*e},className:"flex items-center justify-between px-3 py-2 rounded-xl bg-slate-800/60 text-white",style:{fontSize:"clamp(1rem, 4vw, 1.375rem)"},children:[(0,n.jsxs)("span",{className:"text-white/60",children:[tZ," \xd7 ",e]}),(0,n.jsxs)("span",{className:"font-bold text-cyan-300",children:["= ",tZ*e]})]},e))})}):(0,n.jsx)("div",{className:"space-y-4",children:[1,2,3,4,5].map(e=>(0,n.jsxs)(i.E.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:.1*e},className:"bg-slate-700/60 rounded-xl p-3 border border-slate-600/50",children:[(0,n.jsxs)("div",{className:"text-yellow-300 font-bold text-sm mb-2 px-1",children:["Table of ",e]}),(0,n.jsx)("div",{className:"grid grid-cols-5 gap-1.5",children:Array.from({length:10},(e,t)=>t+1).map(t=>(0,n.jsxs)("div",{className:"text-center py-1 rounded-lg bg-slate-800/60 text-white",style:{fontSize:"clamp(0.7rem, 2.8vw, 0.9rem)"},children:[(0,n.jsxs)("div",{className:"text-white/40",style:{fontSize:"clamp(0.55rem, 2vw, 0.7rem)"},children:[e,"\xd7",t]}),(0,n.jsx)("div",{className:"font-bold text-cyan-300",children:e*t})]},t))})]},e))})})}),(0,n.jsx)("div",{className:"px-4 pb-4 pt-2",children:(0,n.jsx)("div",{className:"max-w-md mx-auto flex flex-col items-center gap-2",children:(0,n.jsx)(i.E.button,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},whileHover:{scale:1.03},whileTap:{scale:.97},onClick:tq,className:"w-full py-3.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl shadow-lg border-2 border-green-400",style:{fontSize:"clamp(1.125rem, 4.5vw, 1.375rem)"},children:"⚔️ I'm Ready!"})})})]})}),(0,n.jsxs)("div",{className:"flex-[55] min-h-0 relative portrait:flex-[45] landscape:flex-[60]",children:[(0,n.jsxs)("div",{className:"absolute left-4 right-4 flex justify-between z-10",style:{top:"calc(env(safe-area-inset-top, 0px) + 72px)"},children:[(0,n.jsxs)("div",{className:"w-[40%]",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsx)("div",{className:"text-white text-sm font-bold drop-shadow",children:"You"}),(0,n.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},className:"px-2 py-0.5 rounded-full text-xs font-bold flex items-center gap-1",style:{background:tm>=3?"linear-gradient(135deg, #a855f7, #ec4899)":tm>=2?"linear-gradient(135deg, #3b82f6, #06b6d4)":"linear-gradient(135deg, #6b7280, #4b5563)",boxShadow:tm>=3?"0 0 8px rgba(168, 85, 247, 0.5)":"none"},children:(0,n.jsxs)("span",{className:"text-white/90",children:[ed.emoji," ",1===tm?"I":2===tm?"II":3===tm?"III":"IV"]})})]}),(0,n.jsx)("div",{className:"h-4 bg-gray-800 rounded-full overflow-hidden",children:(0,n.jsx)(i.E.div,{className:"h-full bg-green-500",animate:{width:"".concat(Math.max(0,eI/em*100),"%")},transition:{duration:.3}})}),(0,n.jsxs)("div",{className:"text-white text-xs mt-1 drop-shadow",children:[Math.max(0,Math.round(eI/em*100)),"%"]})]}),(0,n.jsxs)("div",{className:"w-[40%]",children:[(0,n.jsx)("div",{className:"text-white text-sm font-bold mb-1 text-right drop-shadow",children:"Enemy"}),(0,n.jsx)("div",{className:"h-4 bg-gray-800 rounded-full overflow-hidden",children:(0,n.jsx)(i.E.div,{className:"h-full bg-red-500",animate:{width:"".concat(Math.max(0,eP/eT*100),"%")},transition:{duration:.3}})}),(0,n.jsxs)("div",{className:"text-white text-xs mt-1 text-right drop-shadow",children:[Math.max(0,Math.round(eP/eT*100)),"%"]})]})]}),("player_question"===eR||"enemy_question"===eR)&&(0,n.jsxs)("div",{className:"absolute left-0 right-0 text-center z-10",style:{top:"calc(env(safe-area-inset-top, 0px) + 126px)"},children:[(0,n.jsx)(i.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-lg font-bold drop-shadow-lg px-4 py-2 rounded-full inline-block\n                ".concat(e1?"bg-purple-500/90 text-white animate-pulse":"enemy_question"===eR?"bg-red-500/80 text-white":"bg-blue-500/80 text-white"),children:"player_question"===eR?e1?"⚡ CHARGE SHOT!":"⚔️ ATTACK!":"\uD83D\uDEE1️ DEFEND!"},eR),tZ&&(0,n.jsxs)(i.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-2 text-sm font-bold text-yellow-300 drop-shadow-lg",children:["\uD83D\uDCDA Table of ",tZ]})]}),(0,n.jsx)(l.M,{children:tp&&(0,n.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"absolute inset-0 z-[45] flex items-center justify-center pointer-events-none",children:[(0,n.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:[0,.5,.2,.4,0],background:["linear-gradient(to bottom, rgba(147, 51, 234, 0.5), rgba(59, 130, 246, 0.5))","linear-gradient(to bottom, rgba(234, 179, 8, 0.6), rgba(147, 51, 234, 0.5))","linear-gradient(to bottom, rgba(147, 51, 234, 0.5), rgba(59, 130, 246, 0.5))"]},transition:{duration:4,ease:"easeOut"},className:"absolute inset-0"}),(0,n.jsx)("div",{className:"relative w-full h-full",children:(0,n.jsx)(k.q,{missileType:eo,fromPower:ty,toPower:th,powerName:ed.powerNames[1===th?"I":2===th?"II":3===th?"III":"IV"],isPlaying:tp,onComplete:()=>tx(!1)})})]})}),(0,n.jsx)(D,{missileType:tG,basePowerLevel:ec||1,difficulty:W,battleTableNumber:tZ,isActive:tg,onComplete:(e,t)=>{if(eM.current)return;tv(!1),tj(t),tN.current=t;let a=Math.min(4,(ec||1)+e);tu(a),tf(a),tS(e=>(tz.current=e+1,e+1)),tM(e=>(tH.current=e+1,e+1)),t3("green")}}),(0,n.jsx)(l.M,{children:ti&&e9&&(0,n.jsxs)(i.E.div,{initial:{opacity:0,y:0,scale:.5},animate:{opacity:1,y:-40,scale:1},exit:{opacity:0,y:-80},transition:{duration:.6},className:"absolute z-30 pointer-events-none",style:{left:"enemy"===e9?"90%":"10%",bottom:"12%",transform:"translateX(-50%)"},children:[(0,n.jsx)("div",{className:"text-3xl font-black drop-shadow-lg\n                ".concat(ti.hit?"text-red-500":"text-amber-400"),style:{textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:ti.hit?"-".concat(Math.round(ti.damage)):"Oops! \uD83D\uDCAB"}),ti.blocked>0&&"player"===e9&&(0,n.jsxs)("div",{className:"text-sm font-bold text-cyan-400 text-center mt-1",style:{textShadow:"1px 1px 2px rgba(0,0,0,0.8)"},children:["\uD83D\uDEE1️ Blocked ",Math.round(ti.blocked)]})]})}),(0,n.jsxs)("div",{className:"absolute bottom-0 left-[5%]",children:[(0,n.jsxs)(i.E.div,{className:"relative",animate:"player_flying"===eR?{x:[-8,0],scaleX:[.92,1]}:"enemy_loading"===eR||"enemy_question"===eR?{x:[-2,2,-2]}:{},transition:"player_flying"===eR?{duration:.25,ease:"easeOut"}:{repeat:1/0,duration:.15},children:[(0,n.jsx)(l.M,{children:("enemy_loading"===eR||"enemy_question"===eR||"enemy_flying"===eR||"player"===e9)&&(0,n.jsxs)(i.E.div,{initial:{opacity:0,scale:.8},animate:"player"===e9?"perfect"===tc?{opacity:[1,1.5,1.2,0],scale:[1,1.4,1.5,1.6]}:"good"===tc?{opacity:[1,1.2,.6,0],scale:[1,1.2,1.1,1.3]}:"weak"===tc?{opacity:[1,.5,.2,0],scale:[1,.9,.85,.7],rotate:[0,5,-5,10]}:{opacity:[.6,.2,0],scale:[.8,.5,.3],rotate:[0,-15,25]}:"enemy_flying"===eR&&"failed"===tc?{opacity:[.6,.3,.1],scale:[1,.7,.4]}:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:"player"===e9?{duration:"perfect"===tc?.8:"failed"===tc?.3:.5,ease:"easeOut"}:{duration:.3},className:"absolute -inset-4 z-10 pointer-events-none",children:[(0,n.jsx)(i.E.div,{className:"absolute inset-0 rounded-full",style:{background:(()=>{if("player"===e9)return"perfect"===tc?"radial-gradient(ellipse at center, rgba(34, 197, 94, 0.3) 30%, rgba(34, 197, 94, 0.9) 60%, rgba(74, 222, 128, 0.7) 80%, transparent 100%)":"good"===tc?"radial-gradient(ellipse at center, transparent 30%, rgba(234, 179, 8, 0.7) 65%, rgba(234, 179, 8, 0.4) 85%, transparent 100%)":"weak"===tc?"radial-gradient(ellipse at center, transparent 20%, rgba(239, 68, 68, 0.5) 50%, rgba(239, 68, 68, 0.2) 80%, transparent 100%)":"none";if("enemy_flying"===eR&&"failed"===tc)return"radial-gradient(ellipse at center, transparent 40%, rgba(239, 68, 68, 0.15) 70%, transparent 100%)";let e="green"===eJ?"34, 197, 94":"yellow"===eJ?"234, 179, 8":"239, 68, 68";return"radial-gradient(ellipse at center, transparent 40%, rgba(".concat(e,", 0.4) 70%, transparent 100%)")})(),border:(()=>{if("player"===e9)return"perfect"===tc?"3px solid rgba(34, 197, 94, 1)":"good"===tc?"2px solid rgba(234, 179, 8, 0.8)":"weak"===tc?"1px dashed rgba(239, 68, 68, 0.5)":"none";if("enemy_flying"===eR&&"failed"===tc)return"1px dashed rgba(239, 68, 68, 0.2)";let e="green"===eJ?"34, 197, 94":"yellow"===eJ?"234, 179, 8":"239, 68, 68";return"2px solid rgba(".concat(e,", 0.6)")})(),boxShadow:(()=>{if("player"===e9)return"perfect"===tc?"0 0 40px rgba(34, 197, 94, 1), 0 0 80px rgba(34, 197, 94, 0.5), inset 0 0 30px rgba(34, 197, 94, 0.3)":"good"===tc?"0 0 25px rgba(234, 179, 8, 0.6)":"weak"===tc?"0 0 10px rgba(239, 68, 68, 0.3)":"none";if("enemy_flying"===eR&&"failed"===tc)return"none";let e="green"===eJ?"34, 197, 94":"yellow"===eJ?"234, 179, 8":"239, 68, 68";return"0 0 20px rgba(".concat(e,", 0.5)")})()},animate:"player"===e9?"perfect"===tc?{scale:[1,1.2,1.15,1.2],opacity:[1,1,1,.8]}:"good"===tc?{scale:[1,1.08,1.05],opacity:[1,.9,.6]}:"weak"===tc?{scale:[1,.85,.7],opacity:[.8,.4,.1]}:{scale:[.5,.2,0],opacity:[.3,.1,0]}:"enemy_flying"===eR?"perfect"===tc?{scale:[1,1.1,1.05,1.1,1],opacity:[.9,1,.95,1,.9]}:"good"===tc?{scale:[1,1.06,1,1.06,1],opacity:[.8,.9,.75,.9,.8]}:"weak"===tc?{scale:[1,.95,.9,.95,1],opacity:[.5,.35,.5,.35,.5]}:{scale:[.7,.5,.3],opacity:[.3,.15,0]}:{scale:[1,1.05,1],opacity:[.8,1,.8]},transition:"player"===e9?{duration:"perfect"===tc?.6:.4}:"enemy_flying"===eR&&"failed"===tc?{duration:.6}:{repeat:1/0,duration:"enemy_flying"===eR?.4:1}}),!("enemy_flying"===eR&&"failed"===tc)&&!("player"===e9&&"failed"===tc)&&(0,n.jsx)(i.E.div,{className:"absolute inset-2 rounded-full",style:{opacity:"player"===e9?"perfect"===tc?.7:"good"===tc?.4:.15:.3,backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23".concat("green"===eJ?"22c55e":"yellow"===eJ?"eab308":"ef4444","' fill-opacity='0.4'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")")},animate:"player"===e9&&"weak"===tc?{rotate:[0,15,-10,20],opacity:[.15,.05,0]}:{rotate:[0,360]},transition:"player"===e9&&"weak"===tc?{duration:.4}:{repeat:1/0,duration:"enemy_flying"===eR?8:20,ease:"linear"}}),"player"===e9&&("weak"===tc||"failed"===tc)&&(0,n.jsx)(n.Fragment,{children:[...Array("failed"===tc?6:3)].map((e,t)=>(0,n.jsx)(i.E.div,{className:"absolute",style:{left:"50%",top:"50%",width:"".concat("failed"===tc?120:80,"%"),height:"2px",background:"linear-gradient(90deg, transparent 10%, rgba(239, 68, 68, ".concat("failed"===tc?.9:.5,") 30%, rgba(255, 150, 50, ").concat("failed"===tc?.7:.3,") 70%, transparent 90%)"),transformOrigin:"center",transform:"rotate(".concat(t*("failed"===tc?60:120)+15,"deg)")},initial:{scaleX:0,opacity:0},animate:{scaleX:1,opacity:[0,1,.5]},transition:{duration:.3,delay:.05*t}},"crack-".concat(t)))}),"player"===e9&&"perfect"===tc&&(0,n.jsx)(n.Fragment,{children:[...Array(8)].map((e,t)=>(0,n.jsx)(i.E.div,{className:"absolute text-sm",style:{left:"50%",top:"50%"},initial:{x:0,y:0,opacity:1,scale:.5},animate:{x:40*Math.cos(t*Math.PI/4),y:40*Math.sin(t*Math.PI/4),opacity:[1,1,0],scale:[.5,1.2,.3]},transition:{duration:.6,delay:.03*t},children:"✨"},"sparkle-".concat(t)))}),(0,n.jsx)(i.E.div,{className:"absolute -top-6 left-1/2 -translate-x-1/2 text-2xl",animate:"player"===e9?"perfect"===tc?{y:[0,-12,-8],scale:[1,1.5,1.3],opacity:[1,1,0]}:"good"===tc?{y:[0,-6],scale:[1,1.1],opacity:[1,0]}:"weak"===tc?{y:[0,3,8],scale:[1,.7,.3],opacity:[1,.5,0],rotate:[0,-30,-60]}:{y:[0,10,20],scale:[1,.4,0],opacity:[.5,.2,0],rotate:[0,45,90]}:"enemy_flying"===eR?"perfect"===tc||"good"===tc?{y:[0,-4,0],scale:[1,1.1,1]}:"weak"===tc?{y:[0,1,-1,2,0],rotate:[0,3,-3,2,0],opacity:[.7,.5,.7,.5,.7]}:{y:[0,5,10],opacity:[.4,.15,0],rotate:[0,10,20]}:{y:[0,-3,0]},transition:"player"===e9?{duration:"perfect"===tc?.7:.4}:"enemy_flying"===eR&&"failed"===tc?{duration:.5}:{repeat:1/0,duration:"enemy_flying"===eR?.3:.5},children:"player"===e9&&"failed"===tc?"\uD83D\uDCA5":"\uD83D\uDEE1️"})]})}),(0,n.jsx)(N.y,{tankType:es,className:"w-16 h-12 sm:w-20 sm:h-16 md:w-28 md:h-24",destroyed:(null==eV?void 0:eV.won)===!1&&"battle_end"===eR,skinType:X.selectedTankSkin,colorHex:"factory"===X.selectedTankColor?"":null===(y=f.Yb[X.selectedTankColor])||void 0===y?void 0:y.hex}),(0,n.jsx)(l.M,{children:(null==eV?void 0:eV.won)===!1&&"battle_end"===eR&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:1},animate:{scale:3,opacity:0},transition:{duration:.6},className:"absolute inset-0 rounded-full pointer-events-none",style:{background:"radial-gradient(circle, rgba(255,200,0,0.8), rgba(255,100,0,0.4), transparent)"}}),[...Array(6)].map((e,t)=>{let a=60*t+30,r=40+15*t;return(0,n.jsx)(i.E.div,{initial:{x:0,y:0,rotate:0,opacity:1},animate:{x:Math.cos(a*Math.PI/180)*r,y:[0,-(30+10*t),Math.sin(a*Math.PI/180)*r+20],rotate:360+90*t,opacity:[1,1,0]},transition:{duration:1,ease:"easeOut"},className:"absolute pointer-events-none",style:{left:"50%",top:"50%",width:6+t%3*3,height:4+t%2*3,background:t%2==0?"#78716c":"#a8a29e",borderRadius:2}},"debris-p-".concat(t))}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:.7,y:0},animate:{scale:[0,1.5,2],opacity:[.7,.4,0],y:[-10,-30,-50]},transition:{duration:1.5,delay:.3+.2*t},className:"absolute pointer-events-none rounded-full",style:{left:"".concat(30+12*t,"%"),top:"20%",width:16,height:16,background:t<2?"rgba(100,100,100,0.6)":"rgba(60,60,60,0.5)",filter:"blur(4px)"}},"smoke-p-".concat(t)))]})}),"player_loading"===eR&&(0,n.jsx)(i.E.div,{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-20 h-3 bg-slate-800/80 rounded-full overflow-hidden border border-slate-600",children:(0,n.jsx)(i.E.div,{className:"h-full bg-gradient-to-r from-blue-600 to-cyan-400",style:{width:"".concat(100*tt,"%")}})}),(0,n.jsx)(l.M,{children:"player"===e9&&(0,n.jsxs)(i.E.div,{initial:{scale:0,opacity:1},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.4},className:"absolute inset-0 flex items-center justify-center",children:[(0,n.jsx)(S.Yh,{MissileType:tG,powerLevel:tm,className:"w-16 h-16 sm:w-20 sm:h-20 md:w-28 md:h-28"}),(0,n.jsx)(i.E.div,{initial:{opacity:.6},animate:{opacity:0},transition:{duration:.3},className:"fixed inset-0 pointer-events-none z-[5]",style:{background:"radial-gradient(circle at 10% 90%, rgba(255,150,0,0.3), transparent 60%)"}}),[...Array(6)].map((e,t)=>(0,n.jsx)(i.E.div,{initial:{x:0,y:0,opacity:1},animate:{x:((17*t+5)%11-5)*12,y:-(10+(13*t+3)%8*8),opacity:0},transition:{duration:.5+.05*t},className:"absolute w-1.5 h-1.5 rounded-full bg-yellow-400",style:{boxShadow:"0 0 4px #fbbf24"}},t))]})})]}),(0,n.jsx)(l.M,{children:t_>0&&"battle_end"!==eR&&(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},className:"absolute -top-6 sm:-top-8 left-1/2 -translate-x-1/2 px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-bold",style:{background:t_>=3?"linear-gradient(135deg, #f59e0b, #ef4444)":"linear-gradient(135deg, #3b82f6, #06b6d4)",boxShadow:t_>=3?"0 0 12px rgba(245, 158, 11, 0.6)":"0 0 8px rgba(59, 130, 246, 0.4)"},children:(0,n.jsxs)(i.E.span,{animate:t_>=3?{scale:[1,1.2,1]}:{},transition:{repeat:1/0,duration:.5},className:"flex items-center gap-1 text-white",children:["\uD83D\uDD25 x",t_,t_>=3&&(0,n.jsx)("span",{className:"text-yellow-200",children:"⚡"})]})})})]}),(0,n.jsx)("div",{className:"absolute bottom-0 right-[5%]",children:(0,n.jsxs)(i.E.div,{className:"relative",animate:"enemy_flying"===eR?{x:[8,0],scaleX:[.92,1]}:"player_loading"===eR||"player_question"===eR?{x:[-2,2,-2]}:{},transition:"enemy_flying"===eR?{duration:.25,ease:"easeOut"}:{repeat:1/0,duration:.15},children:[(0,n.jsx)(N.y,{tankType:tY,className:"w-16 h-12 sm:w-20 sm:h-16 md:w-28 md:h-24",facingLeft:!0,destroyed:(null==eV?void 0:eV.won)===!0&&"battle_end"===eR}),(0,n.jsx)(l.M,{children:(null==eV?void 0:eV.won)===!0&&"battle_end"===eR&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:1},animate:{scale:3.5,opacity:0},transition:{duration:.8},className:"absolute inset-0 rounded-full pointer-events-none",style:{background:"radial-gradient(circle, rgba(255,220,0,0.9), rgba(255,80,0,0.5), transparent)"}}),[...Array(8)].map((e,t)=>{let a=45*t,r=35+12*t;return(0,n.jsx)(i.E.div,{initial:{x:0,y:0,rotate:0,opacity:1,scale:1},animate:{x:Math.cos(a*Math.PI/180)*r,y:[0,-(25+8*t),Math.sin(a*Math.PI/180)*r+30],rotate:720+60*t,opacity:[1,1,0],scale:[1,.8,.3]},transition:{duration:1.2,ease:"easeOut"},className:"absolute pointer-events-none",style:{left:"50%",top:"50%",width:5+t%3*4,height:3+t%2*4,background:t%3==0?"#ef4444":t%3==1?"#78716c":"#fbbf24",borderRadius:2}},"debris-e-".concat(t))}),[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:.8,y:0},animate:{scale:[0,1.8,2.5],opacity:[.8,.5,0],y:[-5,-25,-55]},transition:{duration:2,delay:.2+.25*t},className:"absolute pointer-events-none rounded-full",style:{left:"".concat(25+12*t,"%"),top:"15%",width:18,height:18,background:t<2?"rgba(255,100,0,0.5)":"rgba(80,80,80,0.5)",filter:"blur(5px)"}},"smoke-e-".concat(t)))]})}),"enemy_loading"===eR&&(0,n.jsx)(i.E.div,{className:"absolute -top-4 left-1/2 -translate-x-1/2 w-20 h-3 bg-slate-800/80 rounded-full overflow-hidden border border-slate-600",children:(0,n.jsx)(i.E.div,{className:"h-full bg-gradient-to-r from-red-600 to-orange-400",style:{width:"".concat(100*tt,"%")}})}),(0,n.jsx)(l.M,{children:"enemy"===e9&&(0,n.jsxs)(i.E.div,{initial:{scale:0,opacity:1},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},transition:{duration:.4},className:"absolute inset-0 flex items-center justify-center",children:[(0,n.jsx)(S.Yh,{MissileType:tG,powerLevel:tm,className:"w-28 h-28"}),(0,n.jsx)(i.E.div,{initial:{opacity:.5},animate:{opacity:0},transition:{duration:.3},className:"fixed inset-0 pointer-events-none z-[5]",style:{background:"radial-gradient(circle at 90% 90%, rgba(255,100,0,0.35), transparent 60%)"}}),[...Array(8)].map((e,t)=>(0,n.jsx)(i.E.div,{initial:{x:0,y:0,opacity:1},animate:{x:((19*t+3)%13-6)*10,y:-(15+(11*t+7)%9*7),opacity:0},transition:{duration:.4+.04*t},className:"absolute w-1.5 h-1.5 rounded-full",style:{background:t%2==0?"#fbbf24":"#ef4444",boxShadow:"0 0 6px ".concat(t%2==0?"#fbbf24":"#ef4444")}},t)),[void 0,void 0,void 0].map((e,t)=>(0,n.jsx)(i.E.div,{initial:{scale:0,opacity:.5,y:0},animate:{scale:[0,1.2,1.5],opacity:[.5,.3,0],y:[-5,-15,-25]},transition:{duration:.8,delay:.1+.1*t},className:"absolute rounded-full",style:{width:14,height:14,background:"rgba(100,100,100,0.5)",filter:"blur(3px)"}},"smoke-".concat(t)))]})})]})}),(0,n.jsx)(l.M,{children:"ground"===e9&&(0,n.jsxs)(i.E.div,{initial:{scale:0,opacity:1},animate:{scale:1,opacity:0},exit:{opacity:0},transition:{duration:.8},className:"absolute z-10",style:{left:"".concat(e4.x,"%"),bottom:"5%",transform:"translateX(-50%)"},children:[(0,n.jsx)(S.Yh,{MissileType:tG,powerLevel:tm,className:"w-24 h-24"}),[...Array(8)].map((e,t)=>{let a=(23*t+7)%20/20-.5,r=(19*t+3)%20/20;return(0,n.jsx)(i.E.div,{className:"absolute w-3 h-3 bg-amber-700 rounded-sm",style:{left:"50%",top:"50%"},initial:{x:0,y:0,rotate:0},animate:{x:100*a,y:-(80*r)-20,rotate:(31*t+11)%36*10,opacity:0},transition:{duration:.7,ease:"easeOut"}},t)})]})}),(0,n.jsx)(l.M,{children:e8&&(0,n.jsxs)(i.E.div,{className:"absolute z-20",style:{left:"".concat(e4.x,"%"),top:"".concat(e4.y,"%"),transform:"translate(-50%, -50%)"},initial:{opacity:0,scale:.5},animate:{opacity:1,scale:ts?[1,1.8,2.2,1.6]:1},exit:{opacity:0,scale:0},transition:ts?{duration:.8,times:[0,.3,.6,1]}:{},children:[(0,n.jsx)(l.M,{children:ts&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{className:"fixed inset-0 pointer-events-none z-[45]",style:{background:"radial-gradient(circle at center, rgba(251, 191, 36, 0.4), transparent 70%)"},initial:{opacity:0},animate:{opacity:[0,.8,.4,0]},transition:{duration:.5}}),(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:200,height:200,left:"50%",top:"50%",transform:"translate(-50%, -50%)",border:"4px solid rgba(251, 191, 36, 0.8)",boxShadow:"0 0 30px rgba(251, 191, 36, 0.6), inset 0 0 30px rgba(251, 191, 36, 0.3)"},initial:{scale:0,opacity:1},animate:{scale:[0,3,4],opacity:[1,.6,0]},transition:{duration:.6}}),(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:160,height:160,left:"50%",top:"50%",transform:"translate(-50%, -50%)",border:"3px solid rgba(147, 51, 234, 0.8)",boxShadow:"0 0 25px rgba(147, 51, 234, 0.5)"},initial:{scale:0,opacity:1},animate:{scale:[0,2.5,3.5],opacity:[1,.5,0]},transition:{duration:.5,delay:.1}}),(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:100,height:100,left:"50%",top:"50%",transform:"translate(-50%, -50%)",background:"conic-gradient(from 0deg, #fbbf24, #a855f7, #ec4899, #fbbf24)",filter:"blur(3px)"},initial:{scale:0,opacity:0,rotate:0},animate:{scale:[0,1.5,2,1.2],opacity:[0,.8,.6,0],rotate:[0,180,360]},transition:{duration:.7}}),(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:80,height:80,left:"50%",top:"50%",transform:"translate(-50%, -50%)",background:"radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(251, 191, 36, 0.9) 30%, rgba(147, 51, 234, 0.5) 60%, transparent 80%)",boxShadow:"0 0 60px rgba(251, 191, 36, 1), 0 0 100px rgba(147, 51, 234, 0.8)"},initial:{scale:0,opacity:0},animate:{scale:[0,2,2.5,1.5],opacity:[0,1,.8,0]},transition:{duration:.6}}),[...Array(6)].map((e,t)=>(0,n.jsx)(i.E.div,{className:"absolute",style:{left:"50%",top:"50%",width:3,height:60,background:"linear-gradient(to bottom, #fbbf24, #a855f7, transparent)",transformOrigin:"top center",borderRadius:2,filter:"blur(1px)"},initial:{scale:0,rotate:60*t,opacity:0},animate:{scale:[0,1.5,1.2,0],opacity:[0,1,.8,0]},transition:{duration:.5,delay:.05*t}},"lightning-".concat(t))),(0,n.jsx)(i.E.div,{className:"absolute left-1/2 whitespace-nowrap z-10",style:{top:-60},initial:{opacity:0,scale:0,y:40},animate:{opacity:[0,1,1,1,0],scale:[.3,1.4,1.2,1.2,.8],y:[40,0,-5,-5,-20],x:"-50%"},transition:{duration:.8,times:[0,.3,.5,.8,1]},children:(0,n.jsxs)("div",{className:"text-2xl font-black px-4 py-2 rounded-lg",style:{background:"linear-gradient(135deg, rgba(251, 191, 36, 0.9), rgba(147, 51, 234, 0.9))",color:"#ffffff",textShadow:"0 0 10px #fbbf24, 0 0 20px #a855f7, 2px 2px 4px rgba(0,0,0,0.8)",border:"2px solid rgba(255,255,255,0.5)",boxShadow:"0 0 30px rgba(251, 191, 36, 0.8), 0 0 50px rgba(147, 51, 234, 0.5)"},children:["⚡ ",ed.powerNames[1===th?"I":2===th?"II":3===th?"III":"IV"]," ⚡"]})})]})}),(0,n.jsx)(i.E.div,{animate:ts?{scale:[1,1.5,1.8,1.4]}:{},transition:ts?{duration:.8,times:[0,.3,.6,1]}:{},style:{transform:"rotate(".concat(e4.rotation,"deg)")},children:(0,n.jsx)(S.KS,{MissileType:tG,powerLevel:tm,className:"w-16 h-16"})})]})}),(0,n.jsx)(l.M,{children:("enemy"===e9||"player"===e9)&&(0,n.jsxs)(i.E.div,{className:"absolute z-[15]",style:{left:"enemy"===e9?"90%":"10%",bottom:"5%",transform:"translateX(-50%)"},initial:{opacity:1,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0},children:[(0,n.jsx)(S.Yh,{MissileType:tG,powerLevel:tm,className:"w-32 h-32"}),(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:120,height:120,left:"50%",top:"50%",transform:"translate(-50%, -50%)",border:"3px solid rgba(255,200,50,0.7)"},initial:{scale:0,opacity:1},animate:{scale:3,opacity:0},transition:{duration:.5}}),(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:80,height:80,left:"50%",top:"50%",transform:"translate(-50%, -50%)",border:"2px solid rgba(255,150,0,0.6)"},initial:{scale:0,opacity:1},animate:{scale:2.5,opacity:0},transition:{duration:.4,delay:.1}}),[...Array(10)].map((e,t)=>{let a=36*t,r=30+t%3*20;return(0,n.jsx)(i.E.div,{className:"absolute rounded-full pointer-events-none",style:{width:3+t%2*2,height:3+t%2*2,left:"50%",top:"50%",background:t%3==0?"#fbbf24":t%3==1?"#ef4444":"#f97316",boxShadow:"0 0 4px ".concat(t%2==0?"#fbbf24":"#ef4444")},initial:{x:0,y:0,opacity:1},animate:{x:Math.cos(a*Math.PI/180)*r,y:[0,-(15+3*t),Math.sin(a*Math.PI/180)*r],opacity:[1,1,0]},transition:{duration:.6,delay:.02*t}},"hit-debris-".concat(t))}),(0,n.jsx)(i.E.div,{className:"absolute inset-0",animate:{x:[-8,8,-5,5,-2,2,0],y:[-5,5,-3,3,-1,1,0]},transition:{duration:.35}})]})})]}),(0,n.jsx)("div",{className:"flex-[45] min-h-0 bg-slate-800 border-t-4 border-slate-600 portrait:flex-[55] landscape:flex-[40]",children:(0,n.jsxs)("div",{className:"h-full overflow-y-auto p-2 sm:p-3 flex flex-col ".concat(eN?"py-1":""),children:[("player_question"===eR||"enemy_question"===eR)&&eH&&(0,n.jsxs)(n.Fragment,{children:[(()=>{if("player_question"!==eR&&"enemy_question"!==eR)return null;let e=eQ/(tQ+tA.current)*100;return(0,n.jsx)("div",{className:"w-full ".concat(eN?"mb-1":"mb-3"),children:(0,n.jsxs)("div",{className:"".concat(eN?"h-3":"h-4"," bg-slate-700 rounded-full overflow-hidden relative"),children:[(0,n.jsx)(i.E.div,{className:"h-full ".concat(tJ(eJ)," transition-colors duration-200"),style:{width:"".concat(e,"%")},animate:{width:"".concat(e,"%")},transition:{duration:.1}}),(0,n.jsxs)("span",{className:"absolute inset-0 flex items-center justify-center ".concat(eN?"text-[10px]":"text-xs"," font-bold text-white drop-shadow"),children:[eQ.toFixed(1),"s"]})]})})})(),(0,n.jsx)("div",{className:"text-center ".concat(eN?"mb-0.5":"mb-1 sm:mb-2"),children:(0,n.jsx)("div",{className:"font-bold ".concat(e1?"text-purple-300":"text-white"," ").concat(eN?"text-lg":""),style:eN?void 0:{fontSize:"clamp(1.25rem, 5vw, 2rem)"},children:eH.prompt})}),eF?(0,n.jsx)("div",{className:"flex gap-1.5 sm:gap-2 justify-center ".concat(eN?"mb-1":"mb-2 sm:mb-3"),children:eF.split("").map((e,t)=>(0,n.jsx)(i.E.div,{className:"".concat(eN?"w-6 h-7 text-base":"w-8 h-9 sm:w-10 sm:h-11 md:w-11 md:h-12 text-lg sm:text-xl md:text-2xl"," border-b-4 flex items-center justify-center font-bold rounded-t-lg\n              ").concat(eO[t]?"correct"===eZ?"border-green-400 text-green-400 bg-green-400/20":"wrong"===eZ||"timeout"===eZ?"border-red-400 text-red-400 bg-red-400/20":"border-".concat("green"===eJ?"green":"yellow"===eJ?"yellow":"red","-400 text-white bg-slate-700"):"border-slate-500 bg-slate-800"),animate:eO[t]?{scale:[1.1,1]}:{},transition:{duration:.15},children:eO[t]||""},t))}):null,(0,n.jsx)(l.M,{children:eZ&&(0,n.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},className:"text-center mb-2 ".concat("correct"===eZ?"text-green-400":"text-amber-400"),children:"correct"===eZ?(0,n.jsx)("span",{className:"font-bold",style:{fontSize:"clamp(1.25rem, 5vw, 1.75rem)"},children:"✨ Great job! ✨"}):"timeout"===eZ?(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-bold",style:{fontSize:"clamp(1rem, 4vw, 1.5rem)"},children:"⏰ Time's up!"}),(0,n.jsx)("div",{className:"bg-cyan-900/60 border border-cyan-400 rounded-xl p-3 mt-2 mx-auto max-w-xs",children:(0,n.jsx)("div",{className:"font-bold text-cyan-300",style:{fontSize:"clamp(1.5rem, 6vw, 2.25rem)"},children:(null==eH?void 0:null===(b=eH.prompt)||void 0===b?void 0:b.includes("= ?"))?eH.prompt.replace("= ?","= ".concat(eF)):(null==eH?void 0:null===(v=eH.prompt)||void 0===v?void 0:v.includes("\xd7 _"))?"".concat(eH.prompt.split("\xd7")[0].trim()," \xd7 ").concat(eF," = ").concat(null===(j=eH.prompt.split("=")[1])||void 0===j?void 0:j.trim()):"".concat(null==eH?void 0:eH.prompt," → ").concat(eF)})})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"font-bold",style:{fontSize:"clamp(1rem, 4vw, 1.5rem)"},children:"Almost! \uD83D\uDCAA"}),(0,n.jsx)("div",{className:"bg-cyan-900/60 border border-cyan-400 rounded-xl p-3 mt-2 mx-auto max-w-xs",children:(0,n.jsx)("div",{className:"font-bold text-cyan-300",style:{fontSize:"clamp(1.5rem, 6vw, 2.25rem)"},children:(null==eH?void 0:null===(_=eH.prompt)||void 0===_?void 0:_.includes("= ?"))?eH.prompt.replace("= ?","= ".concat(eF)):(null==eH?void 0:null===(I=eH.prompt)||void 0===I?void 0:I.includes("\xd7 _"))?"".concat(eH.prompt.split("\xd7")[0].trim()," \xd7 ").concat(eF," = ").concat(null===(P=eH.prompt.split("=")[1])||void 0===P?void 0:P.trim()):"".concat(null==eH?void 0:eH.prompt," → ").concat(eF)})})]})})}),!eZ&&(()=>{let e=null!==eZ;return eN?(0,n.jsx)("div",{className:"flex gap-1 w-full mx-auto px-1 justify-center",children:["1","2","3","4","5","6","7","8","9","0","⌫","C"].map(t=>(0,n.jsx)(i.E.button,{whileTap:e?{}:{scale:.92},onClick:()=>{"⌫"===t?(eB(e=>e.slice(0,-1)),(0,M.p7)()):"C"===t?(eB(""),(0,M.p7)()):t5(t)},disabled:e,className:"w-10 h-8 text-base font-bold rounded-lg shadow-lg transition-all active:shadow-inner\n                ".concat(e?"bg-slate-700 text-slate-500":"⌫"===t||"C"===t?"bg-slate-600 hover:bg-slate-500 text-white active:bg-slate-700":"".concat(tJ(eJ)," hover:brightness-110 text-white active:brightness-90")),children:t},t))}):(0,n.jsx)("div",{className:"grid grid-cols-3 gap-1.5 sm:gap-2 md:gap-3 w-full mx-auto px-2 sm:px-4 max-w-md",children:["1","2","3","4","5","6","7","8","9","⌫","0","C"].map(t=>(0,n.jsx)(i.E.button,{whileTap:e?{}:{scale:.92},onClick:()=>{"⌫"===t?(eB(e=>e.slice(0,-1)),(0,M.p7)()):"C"===t?(eB(""),(0,M.p7)()):t5(t)},disabled:e,className:"h-11 sm:h-13 md:h-16 text-xl sm:text-2xl md:text-3xl font-bold rounded-xl sm:rounded-2xl shadow-lg transition-all active:shadow-inner\n              ".concat(e?"bg-slate-700 text-slate-500":"⌫"===t||"C"===t?"bg-slate-600 hover:bg-slate-500 text-white active:bg-slate-700":"".concat(tJ(eJ)," hover:brightness-110 text-white active:brightness-90")),children:t},t))})})()]}),("player_loading"===eR||"enemy_loading"===eR)&&(0,n.jsxs)("div",{className:"h-full flex flex-col items-center justify-center",children:[(0,n.jsx)(i.E.div,{animate:{scale:[1,1.2,1],y:"player_loading"===eR?[0,-8,0]:[0,-4,0]},transition:{repeat:1/0,duration:.5},className:"text-6xl mb-6",children:"player_loading"===eR?"\uD83D\uDE80":"\uD83D\uDCA3"}),(()=>{if("player_loading"!==eR&&"enemy_loading"!==eR)return null;let e="player_loading"===eR;return(0,n.jsx)("div",{className:"w-full max-w-xs mx-auto",children:(0,n.jsxs)("div",{className:"h-5 bg-slate-700 rounded-full overflow-hidden border-2 border-slate-600 relative",children:[(0,n.jsx)(i.E.div,{className:"h-full ".concat(e?"bg-gradient-to-r from-blue-600 to-cyan-400":"bg-gradient-to-r from-red-600 to-orange-400"),style:{width:"".concat(100*tt,"%")}}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center gap-1",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsx)(i.E.div,{className:"w-2 h-2 rounded-full ".concat(tt>(t+1)/5?"bg-white":"bg-slate-500"),animate:tt>(t+1)/5?{scale:[1,1.4,1]}:{},transition:{duration:.2}},t))})]})})})()]}),("player_flying"===eR||"enemy_flying"===eR)&&(0,n.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,n.jsx)(i.E.div,{animate:{scale:[1,1.4,1]},transition:{repeat:1/0,duration:.2},className:"text-7xl",children:tn?"\uD83D\uDCA8":"\uD83D\uDCA5"})}),"battle_end"===eR&&eV&&(0,n.jsxs)("div",{className:"h-full flex flex-col items-center justify-center",children:[(0,n.jsx)(i.E.div,{initial:{scale:0},animate:{scale:1},className:"text-6xl mb-4",children:eV.won?"\uD83C\uDFC6":"\uD83D\uDC94"}),(0,n.jsx)("p",{className:"text-white/60 text-sm",children:"See results below..."})]})]})}),(0,n.jsx)(l.M,{children:"battle_end"===eR&&eV&&(0,n.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center",style:{padding:"calc(env(safe-area-inset-top, 0px) + 16px) calc(env(safe-area-inset-right, 0px) + 16px) calc(env(safe-area-inset-bottom, 0px) + 16px) calc(env(safe-area-inset-left, 0px) + 16px)"},children:(0,n.jsxs)(i.E.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",duration:.8},className:"bg-gradient-to-br from-[#1a1a3e] via-[#2a2a5e] to-[#1a1a3e] rounded-3xl shadow-2xl border border-purple-400/30 w-full overflow-y-auto ".concat(eN?"p-3 max-w-sm max-h-[90vh]":"p-6 max-w-md"),children:[(0,n.jsx)(i.E.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-center ".concat(eN?"mb-2":"mb-4"),children:eV.won?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{animate:{rotate:[0,10,-10,10,0],scale:[1,1.1,1]},transition:{repeat:1/0,duration:2},className:eN?"text-4xl mb-1":"text-7xl mb-3",children:"\uD83C\uDFC6"}),(0,n.jsx)("h1",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-400 ".concat(eN?"text-xl mb-0.5":"mb-1"),style:eN?void 0:{fontSize:"clamp(1.5rem, 6vw, 2.5rem)"},children:"VICTORY!"}),(0,n.jsx)("p",{className:"text-green-200/80 ".concat(eN?"text-xs":""),style:eN?void 0:{fontSize:"clamp(0.875rem, 3.5vw, 1rem)"},children:"You destroyed the enemy tank!"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{animate:{rotate:[0,-5,5,-5,0]},transition:{repeat:1/0,duration:2},className:eN?"text-4xl mb-1":"text-7xl mb-3",children:"\uD83D\uDCAA"}),(0,n.jsx)("h1",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-400 ".concat(eN?"text-xl mb-0.5":"mb-1"),style:eN?void 0:{fontSize:"clamp(1.5rem, 6vw, 2.5rem)"},children:"GOOD TRY!"}),(0,n.jsx)("p",{className:"text-amber-200/80 ".concat(eN?"text-xs":""),style:eN?void 0:{fontSize:"clamp(0.875rem, 3.5vw, 1rem)"},children:"Practice makes perfect! Try again! \uD83C\uDF1F"})]})}),(0,n.jsxs)(i.E.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5,type:"spring"},className:"bg-gradient-to-r from-yellow-500/30 to-orange-500/30 backdrop-blur-sm rounded-2xl text-center border border-yellow-400/40 ".concat(eN?"p-1 px-3 mb-1":"p-3 mb-4"),children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 ".concat(eN?"mb-0":"mb-1"),children:[(0,n.jsx)(s.Z,{className:eN?"w-3 h-3 text-yellow-300 fill-yellow-300":"w-5 h-5 text-yellow-300 fill-yellow-300"}),(0,n.jsx)("span",{className:"text-yellow-200 font-bold ".concat(eN?"text-xs":""),style:eN?void 0:{fontSize:"clamp(0.75rem, 3vw, 1rem)"},children:"Coins Earned"}),(0,n.jsx)(s.Z,{className:eN?"w-3 h-3 text-yellow-300 fill-yellow-300":"w-5 h-5 text-yellow-300 fill-yellow-300"})]}),(0,n.jsxs)(i.E.p,{className:"font-bold text-yellow-300 ".concat(eN?"text-xl":""),style:eN?void 0:{fontSize:"clamp(1.5rem, 6vw, 2.5rem)"},animate:{scale:[1,1.1,1]},transition:{repeat:3,duration:.3},children:["+",eV.coinsEarned]})]}),(0,n.jsx)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.7},className:eN?"mb-1":"mb-4",children:(0,n.jsxs)("div",{className:"grid ".concat(eN?"grid-cols-4 gap-1":"grid-cols-2 gap-2"),children:[(0,n.jsxs)("div",{className:"bg-green-500/20 backdrop-blur-sm rounded-xl text-center border border-green-400/30 ".concat(eN?"p-1":"p-3"),children:[(0,n.jsx)("p",{className:"font-bold text-green-400 ".concat(eN?"text-base":""),style:eN?void 0:{fontSize:"clamp(1.25rem, 5vw, 1.75rem)"},children:eV.correctAnswers}),(0,n.jsx)("p",{className:"text-green-200/80 font-medium ".concat(eN?"text-[9px]":""),style:eN?void 0:{fontSize:"clamp(0.625rem, 2.5vw, 0.75rem)"},children:"Correct"})]}),(0,n.jsxs)("div",{className:"bg-red-500/20 backdrop-blur-sm rounded-xl text-center border border-red-400/30 ".concat(eN?"p-1":"p-3"),children:[(0,n.jsx)("p",{className:"font-bold text-red-400 ".concat(eN?"text-base":""),style:eN?void 0:{fontSize:"clamp(1.25rem, 5vw, 1.75rem)"},children:eV.totalShots-eV.correctAnswers}),(0,n.jsx)("p",{className:"text-red-200/80 font-medium ".concat(eN?"text-[9px]":""),style:eN?void 0:{fontSize:"clamp(0.625rem, 2.5vw, 0.75rem)"},children:"Missed"})]}),(0,n.jsxs)("div",{className:"bg-cyan-500/20 backdrop-blur-sm rounded-xl text-center border border-cyan-400/30 ".concat(eN?"p-1":"p-3"),children:[(0,n.jsxs)("p",{className:"font-bold text-cyan-400 ".concat(eN?"text-base":""),style:eN?void 0:{fontSize:"clamp(1.25rem, 5vw, 1.75rem)"},children:[eV.accuracy.toFixed(0),"%"]}),(0,n.jsx)("p",{className:"text-cyan-200/80 font-medium ".concat(eN?"text-[9px]":""),style:eN?void 0:{fontSize:"clamp(0.625rem, 2.5vw, 0.75rem)"},children:"Accuracy"})]}),(0,n.jsxs)("div",{className:"bg-orange-500/20 backdrop-blur-sm rounded-xl text-center border border-orange-400/30 ".concat(eN?"p-1":"p-3"),children:[(0,n.jsxs)("p",{className:"font-bold text-orange-400 ".concat(eN?"text-base":""),style:eN?void 0:{fontSize:"clamp(1.25rem, 5vw, 1.75rem)"},children:[eV.streak,"\uD83D\uDD25"]}),(0,n.jsx)("p",{className:"text-orange-200/80 font-medium ".concat(eN?"text-[9px]":""),style:eN?void 0:{fontSize:"clamp(0.625rem, 2.5vw, 0.75rem)"},children:"Best Streak"})]})]})}),(0,n.jsxs)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.9},className:eN?"space-y-1.5":"space-y-2",children:[eh?(0,n.jsxs)(i.E.div,{initial:{scale:0},animate:{scale:1},className:"w-full rounded-2xl font-bold flex items-center justify-center gap-2 bg-gradient-to-r from-green-500/30 to-emerald-500/30 text-green-300 border border-green-400/50 ".concat(eN?"h-9 text-sm":"h-12"),children:[(0,n.jsx)("span",{className:"text-xl",children:"✅"}),(0,n.jsxs)("span",{children:["+",eu.fuelReward," ⚡ Energy Earned!"]})]}):(0,n.jsxs)("div",{className:"w-full rounded-xl border border-dashed border-orange-400/40 bg-orange-950/20 ".concat(eN?"p-1.5":"p-2"),children:[(0,n.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,n.jsx)("span",{className:"font-bold tracking-widest text-orange-300 uppercase ".concat(eN?"text-[7px]":"text-[8px] sm:text-[9px]"),children:"Advertisement"})}),(0,n.jsx)(i.E.button,{whileHover:{scale:eg.canShow?1.02:1},whileTap:{scale:eg.canShow?.98:1},onClick:async()=>{if(!ep&&eg.canShow){ex(!0);try{(await (0,C.Ho)()).success&&(J(),(0,M.eR)(),(0,M.NH)("heavy"),et(1,"Ad reward"),ef(!0),eb({coins:0,fuel:!0}),ev((0,C.Kc)()))}catch(e){console.error("Ad failed:",e)}ex(!1)}},disabled:ep||!eg.canShow,className:"w-full rounded-lg font-bold flex items-center justify-center gap-2 ".concat(eN?"h-8 text-xs":"h-10 text-sm"," ").concat(ep||!eg.canShow?"bg-gray-700/50 text-gray-400":"bg-orange-600/40 hover:bg-orange-600/50 text-white"),children:ep?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.E.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"},className:"border-2 border-white/30 border-t-white rounded-full ".concat(eN?"w-4 h-4":"w-5 h-5")}),(0,n.jsx)("span",{children:"Playing Ad..."})]}):0===eg.adsRemaining?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{className:"opacity-50 ".concat(eN?"w-4 h-4":"w-5 h-5")}),(0,n.jsx)("span",{children:"Daily limit reached"})]}):eg.canShow?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{className:eN?"w-4 h-4":"w-5 h-5"}),(0,n.jsxs)("span",{children:["Watch Ad for +",eu.fuelReward," ⚡ Energy"]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{className:"opacity-50 ".concat(eN?"w-4 h-4":"w-5 h-5")}),(0,n.jsxs)("span",{children:["Ad ready in ",(e=>{let t=Math.ceil(e/1e3);return"".concat(Math.floor(t/60),":").concat((t%60).toString().padStart(2,"0"))})(eg.cooldownRemaining)]})]})})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{(0,M.NH)("medium"),V?V():G()},className:"flex-1 bg-gradient-to-r from-teal-500/80 to-emerald-500/80 rounded-2xl font-bold text-white border border-teal-400/50 shadow-[0_0_15px_rgba(45,212,191,0.4)] flex items-center justify-center gap-2 ".concat(eN?"h-9 text-sm":"h-12"),children:[(0,n.jsx)(c.Z,{className:eN?"w-4 h-4":"w-5 h-5"}),"Play Again"]}),(0,n.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{(0,M.NH)("light"),G()},className:"flex-1 bg-gradient-to-r from-cyan-500/80 to-blue-500/80 rounded-2xl font-bold text-white border border-cyan-400/50 shadow-[0_0_15px_rgba(34,211,238,0.4)] flex items-center justify-center gap-2 ".concat(eN?"h-9 text-sm":"h-12"),children:[(0,n.jsx)(d.Z,{className:eN?"w-4 h-4":"w-5 h-5"}),"Home"]})]})]})]})})}),(0,n.jsx)("button",{onClick:()=>V?V():G(),className:"absolute left-1/2 -translate-x-1/2 bg-black/50 hover:bg-black/70 text-white px-5 py-2 rounded-full text-sm font-medium z-[45] min-h-[44px] min-w-[44px]",style:{top:"calc(env(safe-area-inset-top, 0px) + 20px)"},children:"← Exit Battle"}),"battle_end"!==eR&&(0,n.jsxs)("div",{className:"absolute flex items-center z-[45]",style:{top:"calc(env(safe-area-inset-top, 0px) + 20px)",right:"calc(env(safe-area-inset-right, 0px) + 16px)",gap:"8px"},children:[(0,n.jsx)(E.F,{variant:"dark",size:"sm"}),(0,n.jsx)("button",{onClick:()=>eY(!eX),className:"bg-black/50 hover:bg-black/70 text-white w-11 h-11 rounded-full flex items-center justify-center",children:eX?(0,n.jsx)(m.Z,{className:"w-5 h-5"}):(0,n.jsx)(u,{className:"w-5 h-5"})})]}),(0,n.jsx)(l.M,{children:eX&&(0,n.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,n.jsxs)(i.E.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-slate-800 rounded-2xl p-6 text-center",children:[(0,n.jsx)("div",{className:"text-5xl mb-4",children:"⏸️"}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"PAUSED"}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)(i.E.button,{whileTap:{scale:.95},onClick:()=>eY(!1),className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-xl flex items-center justify-center gap-2",children:[(0,n.jsx)(m.Z,{className:"w-5 h-5"}),"Resume"]}),(0,n.jsxs)(i.E.button,{whileTap:{scale:.95},onClick:()=>V?V():G(),className:"w-full bg-slate-600 hover:bg-slate-500 text-white font-bold py-3 px-8 rounded-xl flex items-center justify-center gap-2",children:[(0,n.jsx)(d.Z,{className:"w-5 h-5"}),"Exit Battle"]})]})]})})}),(0,n.jsx)(l.M,{children:eU&&(0,n.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center",style:{padding:"calc(env(safe-area-inset-top, 0px) + 16px) calc(env(safe-area-inset-right, 0px) + 16px) calc(env(safe-area-inset-bottom, 0px) + 16px) calc(env(safe-area-inset-left, 0px) + 16px)"},children:(0,n.jsx)(i.E.div,{initial:{scale:.8,y:50},animate:{scale:1,y:0},exit:{scale:.8,y:50},className:"bg-gradient-to-br from-yellow-500 via-orange-500 to-pink-500 rounded-3xl p-1 max-w-sm w-full",children:(0,n.jsxs)("div",{className:"bg-slate-900 rounded-3xl p-6 text-center",children:[(0,n.jsx)(i.E.div,{animate:{rotate:[0,10,-10,10,0],scale:[1,1.1,1]},transition:{repeat:1/0,duration:2},className:"text-6xl mb-4",children:"⭐"}),(0,n.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Enjoying Math Tank?"}),(0,n.jsx)("p",{className:"text-white/70 mb-6 text-sm",children:"Your rating helps other young math champions discover us! It only takes a moment."}),(0,n.jsx)("div",{className:"flex justify-center gap-1 mb-6",children:[1,2,3,4,5].map(e=>(0,n.jsx)(i.E.span,{initial:{scale:0},animate:{scale:1},transition:{delay:.1*e},className:"text-3xl",children:"⭐"},e))}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)(i.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{eK(!1),(0,T.vL)()},className:"w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold py-3 px-6 rounded-xl flex items-center justify-center gap-2 shadow-lg",children:[(0,n.jsx)(s.Z,{className:"w-5 h-5 fill-white"}),"Rate Now"]}),(0,n.jsx)(i.E.button,{whileTap:{scale:.98},onClick:()=>eK(!1),className:"w-full bg-white/10 hover:bg-white/20 text-white/70 font-medium py-3 px-6 rounded-xl",children:"Maybe Later"})]})]})})})})]}):(0,n.jsx)("div",{className:"w-full h-screen flex flex-col bg-gradient-to-b from-pink-300 via-purple-300 to-green-400 overflow-hidden items-center justify-center",style:{minHeight:"100dvh",maxHeight:"100dvh",paddingTop:"calc(env(safe-area-inset-top, 0px) + 16px)",paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:(0,n.jsx)("div",{className:"text-gray-800 font-bold animate-pulse",style:{fontSize:"clamp(1.25rem, 5vw, 1.75rem)"},children:"Loading Battle..."})})}},6799:function(e,t,a){a.d(t,{Hb:function(){return d},Wd:function(){return m},c8:function(){return p},nZ:function(){return c},vL:function(){return u}});let n="https://play.google.com/store/apps/details?id=com.namasya.mathtank",r={REVIEW_PROMPT_COUNT:"mathTank_reviewPromptCount",LAST_REVIEW_PROMPT:"mathTank_lastReviewPrompt",BATTLES_SINCE_PROMPT:"mathTank_battlesSincePrompt",USER_REVIEWED:"mathTank_userReviewed"},i={minBattlesBeforePrompt:3,promptProbability:.2,minBattlesBetweenPrompts:5,maxPromptCount:3,daysBetweenPrompts:3};function l(){return{hasReviewed:"true"===localStorage.getItem(r.USER_REVIEWED),promptCount:parseInt(localStorage.getItem(r.REVIEW_PROMPT_COUNT)||"0",10),lastPromptDate:localStorage.getItem(r.LAST_REVIEW_PROMPT),battlesSincePrompt:parseInt(localStorage.getItem(r.BATTLES_SINCE_PROMPT)||"0",10)}}function s(e){void 0!==e.hasReviewed&&localStorage.setItem(r.USER_REVIEWED,e.hasReviewed.toString()),void 0!==e.promptCount&&localStorage.setItem(r.REVIEW_PROMPT_COUNT,e.promptCount.toString()),void 0!==e.lastPromptDate&&localStorage.setItem(r.LAST_REVIEW_PROMPT,e.lastPromptDate||""),void 0!==e.battlesSincePrompt&&localStorage.setItem(r.BATTLES_SINCE_PROMPT,e.battlesSincePrompt.toString())}function o(e){if(!e)return 1/0;let t=new Date(e);return Math.floor((new Date().getTime()-t.getTime())/864e5)}function c(e){let t=l();return!(t.hasReviewed||e<i.minBattlesBeforePrompt||t.promptCount>=i.maxPromptCount&&o(t.lastPromptDate)<2*i.daysBetweenPrompts||t.battlesSincePrompt<i.minBattlesBetweenPrompts||o(t.lastPromptDate)<i.daysBetweenPrompts)&&Math.random()<i.promptProbability}function d(){s({promptCount:l().promptCount+1,lastPromptDate:new Date().toISOString().split("T")[0],battlesSincePrompt:0})}function m(){s({battlesSincePrompt:l().battlesSincePrompt+1})}function u(){s({hasReviewed:!0}),window.open(n,"_blank")}function p(){"undefined"!=typeof navigator&&navigator.share?navigator.share({title:"Math Tank - Learn \xd7 Battle",text:"\uD83C\uDFAE Math Tank - Learn math through epic tank battles! Perfect for kids ages 4-9. Download now:",url:n}).catch(e=>{console.log("Share failed:",e),x(n)}):x(n)}function x(e){"undefined"!=typeof navigator&&navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{alert("Link copied to clipboard! Share it with friends.")}).catch(()=>{h(e)}):h(e)}function h(e){let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.select();try{document.execCommand("copy"),alert("Link copied to clipboard! Share it with friends.")}catch(t){alert("Share this link with friends: ".concat(e))}document.body.removeChild(t)}}}]);