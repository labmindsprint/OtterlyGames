<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Free Column Multiplication | Step-by-Step Method ‚Äî Otterly Games</title>
  <meta name="description" content="Learn column multiplication step by step. Practice 2-digit multiplication with visual carries and partial products. Free, no download.">
  <link rel="canonical" href="https://otterlygames.com/tools/column-multiplication.html">
  <meta property="og:title" content="Free Column Multiplication | Step-by-Step Method">
  <meta property="og:description" content="Learn column multiplication step by step. Practice 2-digit multiplication with visual carries. Free, no download.">
  <meta property="og:image" content="https://otterlygames.com/images/og-default.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Column Multiplication ‚Äî Step-by-Step">
  <meta name="twitter:description" content="Learn column multiplication step by step with visual carries and partial products.">
  <meta name="twitter:image" content="https://otterlygames.com/images/og-default.png">
  <meta name="pinterest-rich-pin" content="true">
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebApplication","name":"Column Multiplication","applicationCategory":"EducationalApplication","offers":{"@type":"Offer","price":"0"}}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://otterlygames.com/"},{"@type":"ListItem","position":2,"name":"Tools","item":"https://otterlygames.com/tools/"},{"@type":"ListItem","position":3,"name":"Column Multiplication"}]}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"What is column multiplication?","acceptedAnswer":{"@type":"Answer","text":"Column multiplication (also called long multiplication) is a written method for multiplying larger numbers. You stack the numbers, multiply each digit of the bottom number by the top number to create partial products, then add the partial products together to find the answer."}},{"@type":"Question","name":"How do carries work in column multiplication?","acceptedAnswer":{"@type":"Answer","text":"When multiplying two digits gives a result of 10 or more, you write the ones digit below the line and 'carry' the tens digit to the next column on the left. That carried number gets added to the next multiplication result. For example, 7 √ó 8 = 56: write 6 and carry 5."}},{"@type":"Question","name":"When do children learn column multiplication?","acceptedAnswer":{"@type":"Answer","text":"Children typically start learning column multiplication around ages 8‚Äì10 (Year 4 in the UK, Grade 3 in the US). They begin with multiplying a 2-digit number by a 1-digit number before progressing to 2-digit by 2-digit multiplication."}}]}</script>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"HowTo","name":"How to Do Column Multiplication Step by Step","description":"Learn the column multiplication method with carries and partial products using our free interactive tool.","step":[{"@type":"HowToStep","position":1,"name":"Write the numbers","text":"Write the two numbers one above the other, lining up the ones, tens and hundreds columns. Draw a line underneath."},{"@type":"HowToStep","position":2,"name":"Multiply by the ones digit","text":"Multiply each digit of the top number by the ones digit of the bottom number, working right to left. Carry any tens digits to the next column."},{"@type":"HowToStep","position":3,"name":"Multiply by the tens digit","text":"If the bottom number has a tens digit, write a zero placeholder then multiply each digit of the top number by the tens digit, again carrying as needed."},{"@type":"HowToStep","position":4,"name":"Add the partial products","text":"Add the two partial product rows together column by column, carrying where necessary, to get the final answer."}]}</script>
  <link rel="icon" type="image/png" sizes="48x48" href="/images/favicon-48x48.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/images/favicon-192x192.png">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/components.css">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-NX29GXGV7H"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-NX29GXGV7H');</script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5489426086320283" crossorigin="anonymous"></script>
  <style>
    body{min-height:100vh;display:flex;flex-direction:column}
    .hero{padding:6.5rem 1.5rem 2rem;text-align:center;background:linear-gradient(180deg,rgba(26,26,46,.5) 0%,var(--db) 100%)}
    .hero h1{font-size:clamp(1.8rem,5vw,2.8rem);font-weight:900;margin-bottom:.6rem}.hero p{font-size:1rem;color:var(--t2);max-width:560px;margin:0 auto}
    .main{flex:1;max-width:520px;margin:0 auto;padding:1.5rem 1rem 3rem;width:100%}

    /* Difficulty */
    .diff-row{display:flex;gap:.5rem;justify-content:center;margin-bottom:1rem}
    .diff-btn{padding:.5rem 1.2rem;border-radius:999px;font-weight:700;font-size:.82rem;background:var(--dc);border:1px solid var(--dbr);color:var(--t2);transition:.2s}
    .diff-btn:hover{border-color:var(--pp);color:var(--t1)}.diff-btn.active{background:linear-gradient(135deg,var(--pp),var(--pk));color:#0a0a0f;border-color:transparent}

    /* Game Card */
    .gc{background:var(--dc);border:2px solid #6d28d9;border-radius:1.25rem;padding:1.25rem;box-shadow:0 0 40px rgba(109,40,217,.15)}
    .gc-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:.6rem}
    .gc-score{font-size:.9rem;font-weight:700;color:var(--t2)}.gc-score strong{color:var(--t1)}
    .gc-stars{font-size:1.1rem;letter-spacing:2px}.gc-stars .filled{color:var(--pa)}.gc-stars .empty{color:#333}
    .gc-bar{width:100%;height:5px;background:var(--ds);border-radius:3px;margin-bottom:1rem;overflow:hidden}
    .gc-bar-fill{height:100%;background:linear-gradient(90deg,#6d28d9,var(--pk));border-radius:3px;transition:width .4s ease}
    .gc-problem{text-align:center;margin-bottom:.75rem}
    .gc-problem h2{font-size:1.5rem;font-weight:900;margin-bottom:.15rem}
    .gc-problem p{font-size:.8rem;color:var(--t2)}

    /* Workspace */
    .ws{background:rgba(30,41,59,.9);border-radius:.75rem;padding:1rem;margin-bottom:.75rem}
    .ws-grid{display:flex;flex-direction:column;align-items:flex-end;gap:2px;margin:0 auto;width:fit-content}
    .ws-row{display:flex;align-items:center;gap:3px;justify-content:flex-end}
    .ws-cell{width:38px;height:40px;display:inline-flex;align-items:center;justify-content:center;border-radius:8px;font-family:'Nunito',sans-serif;font-size:1.25rem;font-weight:800;flex-shrink:0}
    .ws-num{border:2px solid rgba(99,102,241,.4);color:#60a5fa;background:rgba(99,102,241,.08)}
    .ws-op{width:24px;color:var(--pp);font-size:1.15rem;font-weight:700;display:inline-flex;align-items:center;justify-content:center;border:none}
    .ws-carry{width:22px;height:22px;font-size:.7rem;font-weight:800;color:var(--pa);border:1.5px solid rgba(252,211,77,.3);border-radius:6px;background:rgba(252,211,77,.08);display:inline-flex;align-items:center;justify-content:center}
    .ws-carry-sp{width:22px;height:22px}
    .ws-line{height:3px;background:var(--pp);border-radius:2px;margin:4px 0;width:100%;opacity:.5}
    .ws-label{font-size:.65rem;color:var(--t2);margin-left:6px;font-weight:600;white-space:nowrap}

    /* Digit inputs */
    .d-in{width:38px;height:40px;border:3px solid rgba(74,222,128,.5);background:#fff;color:#7c3aed;border-radius:8px;text-align:center;font-size:1.3rem;font-weight:800;font-family:'Nunito',sans-serif;outline:none}
    .d-in:focus{border-color:var(--pa);box-shadow:0 0 12px rgba(252,211,77,.4)}
    .d-in:disabled{opacity:.35;background:#e5e7eb;cursor:default}
    .d-in::placeholder{color:rgba(124,58,237,.3);font-weight:700}
    .d-in.cyan-b{border-color:rgba(34,211,238,.5)}
    .d-in.yellow-b{border-color:rgba(250,204,21,.5)}
    .d-in.green-b{border-color:rgba(74,222,128,.5)}
    .d-in.placeholder-0{background:#f1f5f9;color:rgba(100,116,139,.5);border-color:rgba(148,163,184,.3);font-size:1.1rem}

    .gc-hint{text-align:center;font-size:.82rem;color:var(--t2);min-height:1.1em;margin-bottom:.4rem}
    .gc-fb{text-align:center;font-size:.95rem;font-weight:700;min-height:1.4rem;margin-bottom:.4rem}
    .gc-fb.ok{color:var(--pg)}.gc-fb.no{color:var(--pk)}
    .gc-check{display:block;width:100%;padding:.8rem;border-radius:12px;font-size:1rem;font-weight:800;color:#fff;background:linear-gradient(135deg,#059669,#10b981);border:none;cursor:pointer;transition:.2s}
    .gc-check:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(5,150,105,.3)}
    .gc-check:active{transform:scale(.98)}

    .gc-complete{text-align:center;padding:.75rem 0}
    .gc-complete h3{font-size:1.2rem;color:var(--pg);margin-bottom:.25rem}
    .gc-complete p{color:var(--t2);font-size:.85rem;margin-bottom:.6rem}
    .gc-next{padding:.6rem 1.8rem;border-radius:999px;font-weight:700;background:linear-gradient(135deg,var(--pp),var(--pk));color:#0a0a0f;font-size:.9rem;transition:.2s}
    .gc-next:hover{transform:scale(1.05)}
    .round-end{text-align:center;padding:1.5rem .75rem}
    .round-end h2{font-size:1.6rem;margin-bottom:.4rem}
    .round-end .big-stars{font-size:1.8rem;letter-spacing:4px;margin-bottom:.4rem}
    .round-end p{color:var(--t2);margin-bottom:.75rem}

    .promo{text-align:center;padding:1.5rem;background:var(--dc);border:1px solid var(--dbr);border-radius:1rem;margin-top:1.5rem}.promo h3{font-size:1.05rem;margin-bottom:.25rem}.promo p{color:var(--t2);font-size:.85rem;margin-bottom:.75rem}
    .promo a{display:inline-block;padding:.55rem 1.3rem;border-radius:999px;font-weight:700;font-size:.82rem;background:linear-gradient(135deg,var(--pp),var(--pk));color:#0a0a0f}
    @keyframes pop{0%{transform:scale(.8);opacity:0}50%{transform:scale(1.05)}100%{transform:scale(1);opacity:1}}
    .pop-in{animation:pop .4s ease}
  </style>
</head>
<body data-og-includes="nav,footer">
  <noscript><div style="max-width:600px;margin:6rem auto 2rem;padding:2rem;background:#141420;border:1px solid #2a2a3e;border-radius:1rem;text-align:center;color:#f0f0f8;font-family:sans-serif"><h2 style="margin-bottom:.5rem">üìä Column Multiplication</h2><p style="color:#9898b0;margin-bottom:.5rem">This interactive column multiplication tool lets you practise step-by-step multiplication with carries and partial products ‚Äî just like on paper.</p><p style="color:#9898b0">Please <strong>enable JavaScript</strong> in your browser to use this tool.</p></div></noscript>
  <section class="hero"><h1>üìä <span class="gt">Column</span> Multiplication</h1><p>Step-by-step column method ‚Äî fill in each digit, just like the Math Tank app!</p></section>
  <div class="main">
    <a href="/tools/" style="display:inline-flex;align-items:center;gap:.4rem;color:#9898b0;font-size:.85rem;font-weight:600;margin-bottom:.75rem;transition:color .2s;text-decoration:none" onmouseover="this.style.color='#c4b5fd'" onmouseout="this.style.color='#9898b0'">‚Üê All Tools</a>
    <div class="diff-row">
      <button class="diff-btn active" id="dE" onclick="setDiff('easy')">Easy (2√ó1)</button>
      <button class="diff-btn" id="dM" onclick="setDiff('medium')">Medium (2√ó2)</button>
    </div>
    <div class="gc" id="gameCard"></div>
    <div class="promo"><h3>ü¶¶ Love this? Try Math Tank!</h3><p>Column multiplication comes alive in epic tank battles!</p><a href="/apps/math-tank.html">Learn About Math Tank ‚Üí</a></div>
  </div>
  <section style="max-width:700px;margin:2rem auto;padding:0 1.5rem">
    <h2 style="font-family:'Nunito',sans-serif;font-size:1.4rem;font-weight:800;color:#f0f0f8;margin-bottom:.6rem">What Is Column Multiplication?</h2>
    <p style="color:#9898b0;font-size:.92rem;line-height:1.7;margin-bottom:.5rem">Column multiplication ‚Äî sometimes called <strong style="color:#c4b5fd">long multiplication</strong> ‚Äî is the standard written method for multiplying multi-digit numbers. Numbers are stacked vertically and multiplied digit by digit, producing partial products that are added together for the final answer.</p>
    <p style="color:#9898b0;font-size:.92rem;line-height:1.7;margin-bottom:1.5rem">This tool uses individual digit cells with carry slots, so children fill in each part of the calculation exactly as they would on paper, building muscle memory for the method.</p>
    <h2 style="font-family:'Nunito',sans-serif;font-size:1.4rem;font-weight:800;color:#f0f0f8;margin-bottom:.6rem">How Carries Work</h2>
    <p style="color:#9898b0;font-size:.92rem;line-height:1.7;margin-bottom:.5rem">When a digit-by-digit multiplication gives a product of 10 or more, the tens digit is "carried" to the next column. For example, 7 √ó 8 = 56: write 6 in the current column and carry 5 to the left.</p>
    <p style="color:#9898b0;font-size:.92rem;line-height:1.7;margin-bottom:1.5rem">Carries are one of the most common stumbling blocks. Practising with immediate visual feedback helps children spot carry mistakes instantly, rather than only discovering them at the end.</p>
    <h2 style="font-family:'Nunito',sans-serif;font-size:1.4rem;font-weight:800;color:#f0f0f8;margin-bottom:.6rem">Tips for Teaching Column Multiplication</h2>
    <p style="color:#9898b0;font-size:.92rem;line-height:1.7;margin-bottom:.5rem">Start with <em>Easy mode</em> (2-digit √ó 1-digit) to build confidence with the layout. Once your child can handle carries comfortably, move to <em>Medium mode</em> (2-digit √ó 2-digit) which introduces partial products.</p>
    <p style="color:#9898b0;font-size:.92rem;line-height:1.7">Encourage your child to check their work by estimating first ‚Äî "Is 38 √ó 7 closer to 200 or 300?" ‚Äî then comparing the estimate with the final answer. Estimation builds number sense alongside the written method.</p>
  </section>
  <div style="max-width:700px;margin:1.5rem auto 2rem;padding:0 1.5rem">
    <h3 style="font-family:'Nunito',sans-serif;font-size:1.1rem;font-weight:800;color:#f0f0f8;margin-bottom:.8rem;text-align:center">üìö Related Tools</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:.75rem">
      <a href="/tools/long-division.html" style="display:block;background:#141420;border:1px solid #2a2a3e;border-radius:.75rem;padding:1rem;text-align:center;transition:border-color .2s;text-decoration:none;color:inherit" onmouseover="this.style.borderColor='#c4b5fd'" onmouseout="this.style.borderColor='#2a2a3e'"><div style="font-size:1.5rem;margin-bottom:.3rem">üìê</div><div style="font-weight:700;font-size:.9rem;color:#f0f0f8;margin-bottom:.2rem">Long Division</div><div style="font-size:.78rem;color:#9898b0">Step-by-step bracket division</div></a>
      <a href="/tools/multiplication-practice.html" style="display:block;background:#141420;border:1px solid #2a2a3e;border-radius:.75rem;padding:1rem;text-align:center;transition:border-color .2s;text-decoration:none;color:inherit" onmouseover="this.style.borderColor='#c4b5fd'" onmouseout="this.style.borderColor='#2a2a3e'"><div style="font-size:1.5rem;margin-bottom:.3rem">‚úñÔ∏è</div><div style="font-weight:700;font-size:.9rem;color:#f0f0f8;margin-bottom:.2rem">Times Tables</div><div style="font-size:.78rem;color:#9898b0">Master √ó2 through √ó12</div></a>
      <a href="/tools/multiplication-table.html" style="display:block;background:#141420;border:1px solid #2a2a3e;border-radius:.75rem;padding:1rem;text-align:center;transition:border-color .2s;text-decoration:none;color:inherit" onmouseover="this.style.borderColor='#c4b5fd'" onmouseout="this.style.borderColor='#2a2a3e'"><div style="font-size:1.5rem;margin-bottom:.3rem">üìã</div><div style="font-weight:700;font-size:.9rem;color:#f0f0f8;margin-bottom:.2rem">Multiplication Table</div><div style="font-size:.78rem;color:#9898b0">Interactive 12√ó12 grid</div></a>
    </div>
  </div>
  <script src="/js/includes.js" defer></script>
  <script>

    const ROUND=5;
    let diff='easy',a,b,correct=0,pNum=0,roundDone=false,done=false;

    function setDiff(d){
      diff=d;
      document.getElementById('dE').classList.toggle('active',d==='easy');
      document.getElementById('dM').classList.toggle('active',d==='medium');
      startRound();
    }

    function gen(){
      if(diff==='easy'){
        a=10+Math.floor(Math.random()*40); b=2+Math.floor(Math.random()*8);
      } else {
        a=11+Math.floor(Math.random()*9); b=11+Math.floor(Math.random()*9);
      }
      done=false;
    }

    function stars(){
      let s='';for(let i=0;i<ROUND;i++) s+='<span class="'+(i<correct?'filled':'empty')+'">'+(i<correct?'‚òÖ':'‚òÜ')+'</span>';return s;
    }

    function render(){
      const gc=document.getElementById('gameCard');
      if(roundDone){
        gc.innerHTML='<div class="round-end pop-in"><h2>üéâ Round Complete!</h2><div class="big-stars">'+stars()+'</div><p>You got <strong>'+correct+'</strong> out of <strong>'+ROUND+'</strong> correct!</p><button class="gc-next" onclick="startRound()">New Round ‚Üí</button></div>';
        return;
      }
      let h='';
      h+='<div class="gc-head"><div class="gc-score">Correct: <strong>'+correct+'</strong>/'+ROUND+'</div><div class="gc-stars">'+stars()+'</div></div>';
      h+='<div class="gc-bar"><div class="gc-bar-fill" style="width:'+(pNum/ROUND*100)+'%"></div></div>';
      h+='<div class="gc-problem"><h2>'+a+' √ó '+b+' = ?</h2><p>'+(diff==='easy'?'2-digit √ó 1-digit':'2-digit √ó 2-digit')+'</p></div>';

      h+='<div class="ws">';
      if(diff==='easy') h+=renderEasy();
      else h+=renderMedium();
      h+='</div>';

      h+='<div class="gc-hint" id="hint"></div>';
      h+='<div class="gc-fb" id="fb"></div>';

      if(!done){
        h+='<button class="gc-check" onclick="check()">Check Answer ‚úì</button>';
      } else {
        h+='<div class="gc-complete pop-in"><h3>‚úÖ '+a+' √ó '+b+' = '+(a*b)+'</h3><p>Great job!</p><button class="gc-next" onclick="next()">Next Problem ‚Üí</button></div>';
      }
      gc.innerHTML=h;
      if(!done) setTimeout(wire,0);
    }

    /* =========== EASY MODE (2√ó1) =========== */
    function renderEasy(){
      const aT=Math.floor(a/10), aO=a%10;
      const product=a*b;
      const pLen=String(product).length;
      let h='<div class="ws-grid">';
      // Carry row placeholder
      h+='<div class="ws-row" id="carryRow" style="visibility:hidden">';
      h+='<div class="ws-carry-sp"></div><div class="ws-carry" id="carryVal"></div><div class="ws-carry-sp"></div>';
      h+='</div>';
      // Top number
      h+='<div class="ws-row"><div class="ws-cell ws-num">'+aT+'</div><div class="ws-cell ws-num">'+aO+'</div></div>';
      // √ó row
      h+='<div class="ws-row"><div class="ws-op">√ó</div><div class="ws-cell ws-num">'+b+'</div></div>';
      // Line
      h+='<div class="ws-line"></div>';
      // Result inputs (ones first, then tens, optionally hundreds)
      h+='<div class="ws-row">';
      if(pLen>=3) h+='<input class="d-in green-b" id="rH" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in green-b" id="rT" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in green-b" id="rO" type="text" inputmode="numeric" maxlength="1" placeholder="?"'+(done?' disabled':'')+' autocomplete="off">';
      h+='</div>';
      h+='</div>';
      return h;
    }

    /* =========== MEDIUM MODE (2√ó2) =========== */
    function renderMedium(){
      const aT=Math.floor(a/10), aO=a%10;
      const bT=Math.floor(b/10), bO=b%10;
      const fp=a*bO; // first partial
      const sp=a*bT; // second partial (without shift)
      const fpLen=String(fp).length;
      const spLen=String(sp).length;
      const product=a*b;
      const prLen=String(product).length;

      let h='<div class="ws-grid">';
      // Top number
      h+='<div class="ws-row"><div class="ws-cell ws-num">'+aT+'</div><div class="ws-cell ws-num">'+aO+'</div></div>';
      // √ó row
      h+='<div class="ws-row"><div class="ws-op">√ó</div><div class="ws-cell ws-num">'+bT+'</div><div class="ws-cell ws-num">'+bO+'</div></div>';
      // Line
      h+='<div class="ws-line"></div>';

      // First partial product row (√óbO)
      h+='<div class="ws-row">';
      if(fpLen>=3) h+='<input class="d-in cyan-b" id="fpH" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in cyan-b" id="fpT" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in cyan-b" id="fpO" type="text" inputmode="numeric" maxlength="1" placeholder="?"'+(done?' disabled':'')+' autocomplete="off">';
      h+='<span class="ws-label">('+bO+'√ó)</span>';
      h+='</div>';

      // Second partial product row (√óbT, shifted)
      h+='<div class="ws-row">';
      if(spLen>=2) h+='<input class="d-in yellow-b" id="spH" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in yellow-b" id="spT" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<div class="ws-cell d-in placeholder-0" style="pointer-events:none">0</div>';
      h+='<span class="ws-label">('+bT+'√ó)</span>';
      h+='</div>';

      // Line 2
      h+='<div class="ws-line"></div>';

      // Total row
      h+='<div class="ws-row">';
      if(prLen>=4) h+='<input class="d-in green-b" id="totTh" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      if(prLen>=3) h+='<input class="d-in green-b" id="totH" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in green-b" id="totT" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<input class="d-in green-b" id="totO" type="text" inputmode="numeric" maxlength="1" placeholder="?" disabled autocomplete="off">';
      h+='<span class="ws-label">(sum)</span>';
      h+='</div>';

      h+='</div>';
      return h;
    }

    /* =========== WIRING =========== */
    function wire(){
      if(diff==='easy') wireEasy();
      else wireMedium();
    }

    function wireEasy(){
      const rO=document.getElementById('rO'), rT=document.getElementById('rT'), rH=document.getElementById('rH');
      const hint=document.getElementById('hint');
      if(!rO)return;
      const aO=a%10, aT=Math.floor(a/10);

      rO.focus();
      if(hint) hint.textContent=b+' √ó '+aO+' = ? (ones digit)';

      rO.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1){
          // Show carry
          const onesProduct=b*aO;
          const carry=Math.floor(onesProduct/10);
          if(carry>0){
            const cr=document.getElementById('carryRow'), cv=document.getElementById('carryVal');
            if(cr){cr.style.visibility='visible';}
            if(cv){cv.textContent=carry;}
          }
          rT.disabled=false;
          setTimeout(()=>{
            rT.focus();
            if(hint){
              const carry=Math.floor(b*aO/10);
              hint.textContent=carry>0?b+' √ó '+aT+' + '+carry+' = ? (tens digit)':b+' √ó '+aT+' = ? (tens digit)';
            }
          },50);
        }
      });

      rT.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1&&rH){
          rH.disabled=false;
          setTimeout(()=>{rH.focus();if(hint)hint.textContent='Hundreds digit';},50);
        } else if(this.value.length===1){
          if(hint)hint.textContent='All done! Click Check Answer';
        }
      });

      if(rH){
        rH.addEventListener('input',function(){
          this.value=this.value.replace(/[^0-9]/g,'');
          if(hint)hint.textContent='All done! Click Check Answer';
        });
      }
    }

    function wireMedium(){
      const fpO=document.getElementById('fpO'), fpT=document.getElementById('fpT'), fpH=document.getElementById('fpH');
      const spT=document.getElementById('spT'), spH=document.getElementById('spH');
      const totO=document.getElementById('totO'), totT=document.getElementById('totT'), totH=document.getElementById('totH'), totTh=document.getElementById('totTh');
      const hint=document.getElementById('hint');
      const bO=b%10, bT=Math.floor(b/10), aO=a%10, aT=Math.floor(a/10);
      const fp=a*bO, sp=a*bT;

      if(!fpO)return;
      fpO.focus();
      if(hint) hint.textContent=bO+' √ó '+aO+' = ? (ones digit)';

      // First partial: ones ‚Üí tens ‚Üí hundreds
      fpO.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1){
          fpT.disabled=false;
          setTimeout(()=>{
            fpT.focus();
            const c=Math.floor(bO*aO/10);
            if(hint) hint.textContent=c>0?bO+' √ó '+aT+' + '+c+' = ?':bO+' √ó '+aT+' = ?';
          },50);
        }
      });
      fpT.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1){
          if(fpH){
            fpH.disabled=false;
            setTimeout(()=>{fpH.focus();if(hint)hint.textContent='Hundreds digit of first partial';},50);
          } else {
            // Move to second partial
            spT.disabled=false;
            setTimeout(()=>{
              spT.focus();
              if(hint) hint.textContent=bT+' √ó '+aO+' = ? (tens digit)';
            },50);
          }
        }
      });
      if(fpH){
        fpH.addEventListener('input',function(){
          this.value=this.value.replace(/[^0-9]/g,'');
          if(this.value.length===1){
            spT.disabled=false;
            setTimeout(()=>{
              spT.focus();
              if(hint) hint.textContent=bT+' √ó '+aO+' = ? (tens digit)';
            },50);
          }
        });
      }

      // Second partial: tens ‚Üí hundreds
      spT.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1){
          if(spH){
            spH.disabled=false;
            setTimeout(()=>{
              spH.focus();
              const c2=Math.floor(bT*aO/10);
              if(hint) hint.textContent=c2>0?bT+' √ó '+aT+' + '+c2+' = ?':bT+' √ó '+aT+' = ?';
            },50);
          } else {
            enableTotal();
          }
        }
      });
      if(spH){
        spH.addEventListener('input',function(){
          this.value=this.value.replace(/[^0-9]/g,'');
          if(this.value.length===1) enableTotal();
        });
      }

      function enableTotal(){
        // Read user's partial products to show in hint
        totO.disabled=false;
        setTimeout(()=>{
          totO.focus();
          if(hint) hint.textContent=fp+' + '+(sp*10)+' = ? (ones digit)';
        },50);
      }

      // Total: ones ‚Üí tens ‚Üí hundreds ‚Üí thousands
      totO.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1){
          totT.disabled=false;
          setTimeout(()=>{totT.focus();if(hint)hint.textContent='Tens digit of total';},50);
        }
      });
      totT.addEventListener('input',function(){
        this.value=this.value.replace(/[^0-9]/g,'');
        if(this.value.length===1){
          if(totH){
            totH.disabled=false;
            setTimeout(()=>{totH.focus();if(hint)hint.textContent='Hundreds digit of total';},50);
          } else if(hint) hint.textContent='All done! Click Check Answer';
        }
      });
      if(totH){
        totH.addEventListener('input',function(){
          this.value=this.value.replace(/[^0-9]/g,'');
          if(this.value.length===1){
            if(totTh){
              totTh.disabled=false;
              setTimeout(()=>{totTh.focus();if(hint)hint.textContent='Thousands digit';},50);
            } else if(hint) hint.textContent='All done! Click Check Answer';
          }
        });
        if(totTh){
          totTh.addEventListener('input',function(){
            this.value=this.value.replace(/[^0-9]/g,'');
            if(hint) hint.textContent='All done! Click Check Answer';
          });
        }
      }
    }

    /* =========== CHECK =========== */
    function check(){
      const fb=document.getElementById('fb');
      if(!fb)return;
      let userAnswer;

      if(diff==='easy'){
        const rO=document.getElementById('rO'), rT=document.getElementById('rT'), rH=document.getElementById('rH');
        if(!rO||!rT) return;
        if(!rO.value||!rT.value||(rH&&!rH.value)){fb.textContent='Fill in all cells first!';fb.className='gc-fb no';return;}
        userAnswer=rH?parseInt(rH.value+rT.value+rO.value):parseInt(rT.value+rO.value);
      } else {
        // Collect all inputs
        const ids=['fpO','fpT','fpH','spT','spH','totO','totT','totH','totTh'];
        const vals={};
        for(const id of ids){
          const el=document.getElementById(id);
          if(el){
            if(!el.value){fb.textContent='Fill in all cells first!';fb.className='gc-fb no';return;}
            vals[id]=parseInt(el.value);
          }
        }
        // Validate each row
        const bO=b%10, bT=Math.floor(b/10);
        const fp=a*bO, sp=a*bT, product=a*b;
        const fpOnes=fp%10, fpTens=Math.floor(fp/10)%10, fpHund=Math.floor(fp/100);
        const spTens=sp%10, spHund=Math.floor(sp/10);
        const tOnes=product%10, tTens=Math.floor(product/10)%10, tHund=Math.floor(product/100)%10, tThou=Math.floor(product/1000);

        const r1ok=vals.fpO===fpOnes&&vals.fpT===fpTens&&(!document.getElementById('fpH')||vals.fpH===fpHund);
        const r2ok=vals.spT===spTens&&(!document.getElementById('spH')||vals.spH===spHund);
        const r3ok=vals.totO===tOnes&&vals.totT===tTens&&
          (!document.getElementById('totH')||vals.totH===tHund)&&
          (!document.getElementById('totTh')||vals.totTh===tThou);

        if(r1ok&&r2ok&&r3ok){
          fb.textContent='‚úÖ Correct!';fb.className='gc-fb ok';correct++;
          done=true;pNum++;
          disableAll();
          setTimeout(()=>{if(pNum>=ROUND)roundDone=true;render();},1500);
          return;
        } else {
          fb.textContent='‚úó Answer: '+a+' √ó '+b+' = '+(a*b);fb.className='gc-fb no';
          done=true;pNum++;
          disableAll();
          setTimeout(()=>{if(pNum>=ROUND)roundDone=true;render();},1500);
          return;
        }
      }

      // Easy mode check
      const product=a*b;
      if(userAnswer===product){
        fb.textContent='‚úÖ Correct!';fb.className='gc-fb ok';correct++;
      } else {
        fb.textContent='‚úó Answer: '+a+' √ó '+b+' = '+product;fb.className='gc-fb no';
      }
      done=true;pNum++;
      disableAll();
      setTimeout(()=>{if(pNum>=ROUND)roundDone=true;render();},1500);
    }

    function disableAll(){
      document.querySelectorAll('.d-in').forEach(el=>el.disabled=true);
    }

    function next(){if(pNum>=ROUND){roundDone=true;render();return;}gen();render();}
    function startRound(){correct=0;pNum=0;roundDone=false;gen();render();}
    gen();render();
  </script>
</body>
</html>
